                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

bool LocIsModoc(uint locPid)
{
	return(locPid<=(1253));
}

bool LocIsCity(uint locPid)
{
	return(locPid<=(32)||locPid==(1216)||locPid==(43)||locPid==96);
}

bool LocIsMasked(uint locPid)
{
	return(locPid==(42));
}

bool LocIsHidden(uint locPid)
{
	return false;
}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

shared interface Project
{
	string@get_Name();
	void Build();
	void SetAssociation(string@ex,string@className,string@classModule);
}

shared interface FileObject
{
	string@get_DictKey();
	string@get_ObjectName()const;
	void FormatStringData(string&nameData,string&data);
	FileObject@get_Pattern(string&name)const;
	FileObject@get_Copy(string&name); 
	
	void set_GlobalData(string@name,string@value);          
	
	string@get_GlobalData(string@name);            
	
}

shared class TimeLog
{
	uint tick;
	
	TimeLog()
	{
		refresh();
	}
	
	void refresh()
	{
		tick=GetTick();
	}
	
	bool check(uint count)
	{
		return(GetTick()-tick>=count);
	}
	
	uint get()
	{
		uint old=tick;
		refresh();
		return(tick-old);
	}
	
	void Log(string&in message)
	{
		::ClearLog(message+" ["+(GetTick()-tick)+"ms]");
	}
}

shared interface AnyDataObject
{
	string@get_DictKey();
	string@get_ObjectName()const;
	uint[]@get_SaveData();
	void InitData(uint[]&data);
}

shared interface ManagerObject
{
	FileObject@get_ProtoObject(string@name);
	void ParseProtoTypes(const string&ex,const FileObject&pattern,const string@search);
	FileObject@ParseProtoTypeFile(string&name,const string&ex,const FileObject&pattern,const string@search);
	FileObject@AddPrototype(FileObject@proto);
	FileObject@StringToFileObject(string&name,string&txt,const FileObject&pattern);
}

shared interface ValueAPI{}
shared class SettingsAPI
{
	string Name;
	bool IsDebug;
} 

shared class GlobalData
{
	uint Hash;
	string Value;
	
	GlobalData(string@name)
	{
		Hash=GetStrHash(name);
		Value="";
	} 
	
	void SaveData(uint[]&outArray,uint&position)
	{
		uint len=Value.length();
		
		outArray.resize(position+2+len/2);
		
		outArray[position++]=Hash;
		outArray[position++]=len;
		
		for(uint i=0;i<len;i++)
		{
			outArray[position]|=Value[i++]<<24;
			outArray[position]|=Value[i++]<<16;
			outArray[position]|=Value[i++]<<8;
			outArray[position++]|=Value[i];
		}
	} 
	
	void LoadData(uint[]&in outArray,uint&position)
	{
		Hash=outArray[position++];
		uint len=outArray[position++];
		Value.resize(len);
		
		for(uint i=0;i<len;i++)
		{
			Value[i++]=(outArray[position]>>24)&0xFF;
			Value[i++]=(outArray[position]>>16)&0xFF;
			Value[i++]=(outArray[position]>>8)&0xFF;
			Value[i]=outArray[position++]&0xFF;
			
		}
	}
} 

shared class Hexagonal
{
	Hexagonal(){Reset();}
	Hexagonal(const uint16&in x,const uint16&in y){Set(x,y);}
	Hexagonal(const Hexagonal&master){Set(master);}
	
	Hexagonal(const Critter&master){Set(master.HexX,master.HexY);}
	Hexagonal(const Item&master){Set(master.HexX,master.HexY);}
	Hexagonal(const Scenery&master){Set(master.HexX,master.HexY);}
	
	bool Entire(Map&map,int entNum){return map.GetEntireCoords(entNum,0,X,Y);}
	bool IsPassed(Map&map){return ValidPosition(map)&&map.IsHexPassed(X,Y);}
	bool IsPassed(Map&map,Hexagonal&begin,Hexagonal&end){return ValidPosition(map,begin,end)&&map.IsHexPassed(X,Y);}
	
	bool ValidPosition(Map&map)
	{
		Hexagonal end,begin;
		if(end.Entire(map,0)&&begin.Entire(map,255))
		return ValidPosition(map,begin,end);
		return false;
	}
	
	bool ValidPosition(Map&map,Hexagonal&begin,Hexagonal&end)
	{
		return(X>=begin.X&&Y>=begin.Y
		&&X<=end.X&&Y<=end.Y);
	}
	
	bool Transit(Critter&critter,Map&map){return Transit(critter,map,critter.Dir);}
	bool Transit(Critter&critter,Map&map,uint8 direction)
	{
		if(!IsPassed(map))return false;
		return critter.TransitToMap(map.Id,X,Y,direction);
	}
	
	bool Transit(Critter&critter,uint mapId){return Transit(critter,mapId,critter.Dir);}
	bool Transit(Critter&critter,uint mapId,uint8 direction)
	{
		if(mapId==0)return false;
		Map@map=GetMap(mapId);
		if(@map is null)return false;
		return Transit(critter,map,direction);
	} 
	
	void Set(const uint16&in x,const uint16&in y){X=x;Y=y;}
	void Set(const Hexagonal&in other){Set(other.X,other.Y);}
	void Reset(){X=Y=0;}
	uint Distantion(Hexagonal&other){return GetDistantion(X,Y,other.X,other.Y);}
	
	uint16 X;
	uint16 Y;
	
	bool opEquals(const Hexagonal&in other){return(other.X==X&&other.Y==Y);}
	Hexagonal&opAssign(const Hexagonal&in other)
	{
		Set(other);
		return this;
	}
	
	const uint get_UID(const uint w)const{return X+Y*w;}
	string get_Debug(){return"X:"+X+"Y:"+Y;}
	void Log(string&str){::Log(str+":"+Debug);}
}    

shared class MapHash
{
	MapHash(const uint16&in protoId)
	{
		ProtoId=protoId;
		@Min=null;
		@Max=null;
	}
	
	MapHash&opAssign(Map&map)
	{
		@Min=Hexagonal(0,0);
		@Max=Hexagonal(0,0);
		map.GetEntireCoords(0,0,Max.X,Max.Y);
		map.GetEntireCoords((255),0,Min.X,Min.Y);
		return this;
	}
	
	uint16 ProtoId;
	Hexagonal@Min;
	Hexagonal@Max;
} 

shared class Line
{
	Line(Hexagonal&a,Hexagonal&b){@A=a;@B=b;}
	
	uint get_Length()
	{
		return B.Distantion(A);
	}
	
	uint get_Point(Hexagonal&point)
	{
		return B.Distantion(point);
	}
	
	float get_Module(Hexagonal&point)
	{
		return Point[point]/Length;
	}
	
	Hexagonal@get_opIndex(const uint&in size)
	{
		
		const float mod=float(size/Length);
		return@Hexagonal(A.X+(B.X-A.X)*mod,A.Y+(B.Y-A.Y)*mod);
	} 
	
	Line(Map&map,uint16 grid,MapHash@hash)
	{
		if(@hash is null)
		{
			Hexagonal min,max;
			map.GetTransferParams(min.X,min.Y,max.X,max.Y,grid);
			
			@A=@Hexagonal(min.X,min.Y);
			@B=@Hexagonal(max.X,max.Y);
		}
		else
		{
			if(@hash.Min is null||@hash.Max is null)
			map.GetTransferParams(hash.Min.X,hash.Min.Y,hash.Max.X,hash.Max.Y,grid);
			
			@A=@Hexagonal(hash.Min.X,hash.Min.Y);
			@B=@Hexagonal(hash.Max.X,hash.Max.Y);
		}
	} 
	
	string get_Debug(){return"A<"+A.Debug+">B<"+B.Debug+">";}
	void Log(string&str){::Log(str+":"+Debug);}
	
	Hexagonal@A;
	Hexagonal@B;
}  

import MapHash@GetMapHash(const uint16&in pid)from"world";
import uint CreateLocation(Hexagonal&coordinate,uint16 locationPid)from"world"; 

import ManagerObject@get_objectManager()from"world"; 

import EventTree@get_EventRoot()from"world"; 

import Project@CreateProject(string@name,string@path)from"main";
import Project@get_Project(string@name)from"main";                                                                                                                               

uint __GetColor(int r,int g,int b)
{
	r=(((r)>(255))?(255):(((r)<(0))?(0):(r)));
	g=(((g)>(255))?(255):(((g)<(0))?(0):(g)));
	b=(((b)>(255))?(255):(((b)<(0))?(0):(b)));
	return(uint((0xFF<<24)|(((r)&0xFF)<<16)|(((g)&0xFF)<<8)|((b)&0xFF)));
}

uint __GetGradient(uint colorStart,uint colorEnd,uint8 pos)
{
	pos=(((pos)>(100))?(100):(((pos)<(1))?(1):(pos)));
	
	int aS=(colorStart>>24)&0xFF,
	rS=((colorStart>>16)&0xFF),
	gS=((colorStart>>8)&0xFF),
	bS=((colorStart)&0xFF),
	
	aE=(colorEnd>>24)&0xFF,
	rE=((colorEnd>>16)&0xFF),
	gE=((colorEnd>>8)&0xFF),
	bE=((colorEnd)&0xFF); 
	
	rS=(((rE-int(rS*(pos*0.01)))>0)?(rE-int(rS*(pos*0.01))):-(rE-int(rS*(pos*0.01))));
	gS=(((gE-int(gS*(pos*0.01)))>0)?(gE-int(gS*(pos*0.01))):-(gE-int(gS*(pos*0.01))));
	bS=(((bE-int(bS*(pos*0.01)))>0)?(bE-int(bS*(pos*0.01))):-(bE-int(bS*(pos*0.01))));
	
	return __GetColor(rS,gS,bS);
}

uint __GetColor(uint8&a,uint8&r,uint8&g,uint8&b,uint color){
	a=(color>>24)&0xFF;
	r=((color>>16)&0xFF);
	g=((color>>8)&0xFF);
	b=((color)&0xFF);
	
	return 0;
}                                        

import uint GetAllPlayers(Critter@[]&crs)from"manager";
import void RestartFactions(Critter&cr,int p0,int p1,int p2)from"factions";
import void OpenCrate(Critter&player,uint type)from"map_start";
import void ShowInputBoxScreen(Critter&cr,string funcName,uint16 textLength,uint8 flags)from"main";
import void Warn(Critter&admin,int param0,int param1,int param2)from"warning";
import void SetWorkbench(Critter&cr,int item_id,int item_type,int p2)from"item";
import void ChangeCritterSpeed(Critter&cr)from"speed";
import bool ItemLockedCont(Item&item)from"item";
import bool IsDoorAutomatic(uint pid)from"interactive_obj";
import void ChangeStatus(Critter&cr,uint16 status,uint8 value,bool set)from"critter_status";                     

void LogErr(string text){Log("[ERORR] "+text);}
bool invalidCritter(Critter@cr)
{
	if(@cr is null)
	{
		LogErr("Critter is null");
		return true;
	}
	return false;
}

bool validCritter(Critter@cr){return!invalidCritter(@cr);}
bool SayCr(Critter@cr,string text)
{
	if(validCritter(@cr))
	{
		cr.Say((11),text);
		return true;
	}
	return false;
}

bool wrongString(string@text){return(!(@text!=null)||text.length()==0);}
string TextOrDefault(string@original_text,string@default_text)
{
	return(wrongString(original_text)?(wrongString(default_text)?"[ERROR]":default_text):original_text);
} 

enum ModocPost
{
	None,
	Sheriff,
	Major,
}

bool SetPost(Critter&player,ModocPost value){return SetPost(player.Id,value);}
bool SetPost(int player_id,ModocPost value)
{
	GameVar@post=GetLocalVar((7301),player_id);
	if(@post is null)
	return false;
	post=value;
	return true;
}   

void BecomeMajor(Critter&player,int param0,int param1,int param2)
{
	Critter@target=@player;
	if(param0!=0)@target=GetCritter(param0);
	if(!(@target!=null))@target=@player;
	if(SetPost(target,ModocPost::Major))
	target.Say((11),"Вы добились успеха, теперь этот город принадлежит вам!");
}

void BecomeSheriff(Critter&player,int param0,int param1,int param2)
{
	Critter@target=@player;
	if(param0!=0)@target=GetCritter(param0);
	if(!(@target!=null))@target=@player;
	target.Say((11),"Пришло время жевать жвачку и пинать задницы!");
}

void ErasePost(Critter&player,int param0,int param1,int param2)
{
	Critter@target=@player;
	if(param0!=0)@target=GetCritter(param0);
	if(!(@target!=null))@target=@player;
	target.Say((11),"Вы потеряли все привелегии, опять всё с нуля..");
} 

void _gmAddKey(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(param1==0&&param0!=0)
	{
		Item@locker=GetItem(param0);
		if(!(@locker!=null))
		{
			SayCr(player,"Объект не найден!");
			return;
		}
		bool isDoor=locker.GetType()==(9);
		if(IsDoorAutomatic(locker.GetProtoId()))
		{
			SayCr(player,"Это автоматическая дверь, ей не нужен ключ.");
			return;
		}
		
		if((((locker.LockerCondition)&((0x20)))!=0))
		{
			SayCr(player,"На "+(isDoor?"двери":"контейнере")+" стоит электронный замок!");
			return;
		}
		if((locker.LockerCondition!=(0x02)))
		{
			SayCr(player,"На "+(isDoor?"двери":"контейнере")+" нет замка!");
			return;
		}
		param1=locker.LockerId;
	}
	
	if(param1==0)
	{
		SayCr(player,"Нет такого номера ключа, что бы сделать дубликат!");
		return;
	}
	if(param2==0)param2=1;
	@param3=TextOrDefault(@param3,"some key");
	for(int i=0;i<param2;i++)
	{
		Item@newKey=player.AddItem((1313),1);
		newKey.LockerId=param1;
		newKey.SetLexems("$KeyLex"+param3);
		newKey.Update();
	}
	SayCr(player,"Вы изготовили ключ(count:"+param2+") для замка №"+param1);
	return;
}

void GM_getItemsByPid(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	getItemsByPid(player,param0,param1,param2);
}

void getItemsByPid(Critter&player,int param0,int param1,int param2)
{
	Item@[]items;
	uint count=GetAllItems(param0,items);
	player.Say((11),"Count: "+count);
	
	Item@item=null;
	
	for(uint i=0;i<count;i++)
	{
		@item=items[i];
		if(!(@item!=null))
		continue;
		
		switch(item.Accessory)
		{
			case(2):
			{
				Map@map=GetMap(item.MapId);
				if(!(@map!=null))
				{
					player.Say((11),"#"+item.Id+": map "+item.MapId+" not valid");
					continue;
				}
				player.Say((11),"#"+item.Id+": map "+map.Id+" ("+item.HexX+", "+item.HexY+")");
			}
			break;
			case(1):
			{
				Critter@cr=GetCritter(item.CritId);
				if(!(@cr!=null))
				{
					player.Say((11),"#"+item.Id+": crit "+item.CritId+" not valid");
					continue;
				}
				Map@map=cr.GetMap();
				if((@map!=null))
				{
					player.Say((11),"#"+item.Id+": crit "+cr.Id+" (map "+map.Id+": "+cr.HexX+", "+cr.HexY+")");
				}
				else
				{
					player.Say((11),"#"+item.Id+": crit "+cr.Id+" (global)");
				}
			}
			break;
			case(3):
			{
				Map@map=GetMap(item.MapId);
				if(!(@map!=null))
				{
					player.Say((11),"#"+item.Id+": map "+item.MapId+" not valid");
					continue;
				}
				
				Item@cont=map.GetItem(item.ContainerId);
				if(!(@cont!=null))
				continue;
				
				player.Say((11),"#"+item.Id+": map "+map.Id+" (cont "+cont.Id+": "+cont.HexX+", "+cont.HexY+")");
			}
			break;
		}
	}
}

void delItemsByPid(Critter&player,int param0,int param1,int param2)
{
	Item@[]items;
	uint count=GetAllItems(param0,items);
	DeleteItems(items);
	player.Say((11),"Deleted "+count+" items.");
}

class Replic
{
	uint Author;
	uint Speaker;
	uint8 SayType;
	string Buffer;
	Replic()
	{
		Author=0;
		Speaker=0;
		SayType=0;
		Buffer="";
	}
}

Replic[]replics;

void GM_voice(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	player.StatBase[(91)]=param0;
	player.StatBase[(92)]=param1;
	ShowInputBoxScreen(player,"gm@unsafe_answer_GM_voice#text",0,(0x00000001));
}

void unsafe_answer_GM_voice(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(@param3!is null&&param3.length()!=0)
	{
		Map@map=player.GetMap();
		map.SetText(player.Stat[(91)],player.Stat[(92)],((uint((0xFF<<24)|(((0x7F)&0xFF)<<16)|(((0x7F)&0xFF)<<8)|((0x7F)&0xFF)))),param3);
		player.Say((11),param3);
	}
	Log("Checkpoint #1");
}

void GM_say(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	say(player,param0,param1,param2);
}

void say(Critter&player,int param0,int param1,int param2)
{
	if(param0<1)
	{
		player.Say((11),"Wrong critter Id.");
		return;
	}
	
	Critter@cr=GetCritter(param0);
	
	if(cr is null)
	{
		player.Say((11),"Can't find critter by Id.");
		return;
	}
	
	if(param1<1||param1>11)
	{
		player.Say((11),"Wrong SayType.");
		return;
	}
	
	player.StatBase[(91)]=cr.Id;
	player.StatBase[(92)]=param1;
	if(param1==1)
	ShowInputBoxScreen(player,"gm@unsafe_answer_GM_say#сказать",0,(0x00000001));
	else if(param1==5)
	ShowInputBoxScreen(player,"gm@unsafe_answer_GM_say#эмоут",0,(0x00000001));
	else
	ShowInputBoxScreen(player,"gm@unsafe_answer_GM_say#текст",0,(0x00000001));
}

void unsafe_answer_GM_say(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(@param3!is null&&param3.length()!=0)
	{
		Critter@cr=GetCritter(player.Stat[(91)]);
		cr.Say(player.Stat[(92)],param3);
		say(player,player.Stat[(91)],player.Stat[(92)],0);
	}
}

void answer_gm_say(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()<2||answerS.length()>64)
	{
		player.Say((11),"Wrong text length.");
		delAuthor(player.Id);
		return;
	}
	
	uint len=replics.length();
	Replic@rep=null;
	
	for(uint i=0;i<len;i++)
	{
		if(replics[i].Author!=player.Id)
		continue;
		@rep=replics[i];
		break;
	}
	if(rep is null)
	{
		player.Say((11),"Can't find replic.");
		delAuthor(player.Id);
		return;
	}
	
	Critter@cr=GetCritter(rep.Speaker);
	
	if(cr is null)
	{
		player.Say((11),"Can't find critter.");
		delAuthor(player.Id);
		return;
	}
	
	rep.Buffer+=answerS;
	
	if(answerS[answerS.length()-1]==43)
	{
		rep.Buffer.resize(rep.Buffer.length()-1);
		
		player.ShowScreen((5),0,"answer_gm_say");
		player.Say((39),"Сказать...");
		
		return;
	}
	
	cr.Say(rep.SayType,rep.Buffer);
	player.Say((11),"Ok.");
	
	delAuthor(player.Id);
}

void delAuthor(uint id)
{
	uint len=replics.length();
	
	for(uint i=0;i<len;i++)
	{
		if(replics[i].Author!=id)
		continue;
		replics.removeAt(i);
		break;
	}
}

void PlayersHP(Critter&player,int param0,int param1,int param2)
{
	Critter@[]crs;
	GetAllPlayers(crs);
	
	for(uint i=0;i<crs.length();i++)
	{
		Critter@cr=crs[i];
		if(cr is null)
		continue;
		player.Say((11),"Id: "+cr.Id+" BaseMaxHP: "+cr.StatBase[(7)]+" MaxHP: "+cr.Stat[(7)]);
	}
}

void dec15hp(Critter&player,int param0,int param1,int param2)
{
	if(param0!=0)
	{
		Critter@cr=GetCritter(param0);
		if(!(cr is null))
		{
			if(cr.StatBase[(7)]>15)
			cr.StatBase[(7)]-=15;
			else
			cr.StatBase[(7)]=0;
		}
		return;
	} 
	
	Critter@[]crs;
	GetAllPlayers(crs);
	
	for(uint i=0;i<crs.length();i++)
	{
		Critter@cr=crs[i];
		if((cr is null)||cr.StatBase[(7)]!=15)
		continue;
		cr.StatBase[(7)]=0;
		player.Say((11),"Id: "+cr.Id+"  базовые MaxHP сброшены на 0.");
	}
}

void dec75hp(Critter&player,int param0,int param1,int param2)
{
	Critter@[]crs;
	GetAllPlayers(crs);
	
	for(uint i=0;i<crs.length();i++)
	{
		Critter@cr=crs[i];
		if((cr is null)||cr.StatBase[(7)]!=75)
		continue;
		cr.StatBase[(7)]=0;
		player.Say((11),"Id: "+cr.Id+"  базовые MaxHP сброшены на 0.");
	}
} 

void sleep(Critter&player,int param0,int param1,int param2)
{
	Critter@cr=null;
	if(param0>0)
	{
		@cr=GetCritter(param0);
		if(cr is null)
		return;
	}
	else
	@cr=player;
	
	if(cr.IsKnockout())
	{
		cr.StatBase[(75)]=0;
		if(cr.Stat[(72)]>0)
		cr.ToLife();
	}
	else
	cr.ToKnockout(((param1==0)?(82):(83)),((param1==0)?(86):(87)),((param1==0)?(88):(89)),9999,cr.HexX,cr.HexY);
}

void _sinf(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	sinf(player,0,param0,0);
}

void sinf(Critter&player,int param0,int param1,int param2)
{
	Critter@cr=null;
	if(param0>0)
	{
		@cr=GetCritter(param0);
		if(cr is null)
		return;
	}
	else
	@cr=player;
	
	cr.RunClientScript("client_main@_sinf",param1,0,0,null,null);
}

uint last_s2a_author=0;

void _say2all(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	Critter@[]crs;
	GetAllPlayers(crs);
	
	string str="|0xFFFF0000 ### |0xFFBB33CC "+param3+" |0xFFFF0000 ###";
	
	int acc=player.GetAccess();
	
	for(uint i=0,j=crs.length();i<j;i++)
	{
		if(crs[i]is null)
		continue;
		
		if(crs[i].GetAccess()>=acc)
		crs[i].Say((11),"|0xFFFF0000 <|0xFFFFFF00 "+GetPlayerName(player.Id)+"|0xFFFF0000 >"+str);
		else
		crs[i].Say((11),str);
	}
	
	last_s2a_author=player.Id;
}

void unsafe_ans(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(player.Stat[(95)]>3)
	return;
	player.StatBase[(95)]+=1;
	
	Critter@cr=GetCritter(last_s2a_author);
	if(cr is null)
	return;
	
	cr.Say((11),"s2a-answer |0xFFFF0000 <|0xFFFFFF00 "+GetPlayerName(player.Id)+"("+player.Id+")|0xFFFF0000 > |0xFFBB33CC "+param3);
}

void unsafe_help(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(player.Stat[(95)]>3)
	return;
	player.StatBase[(95)]+=1;
	
	Critter@[]crs;
	GetAllPlayers(crs);
	
	string str="help |0xFFFF0000 <|0xFFFFFF00 "+GetPlayerName(player.Id)+"("+player.Id+")|0xFFFF0000 > |0xFFBB33CC "+param3;
	
	for(uint i=0,j=crs.length();i<j;i++)
	{
		if(crs[i]is null or crs[i].GetAccess()<(2))
		continue;
		crs[i].Say((11),str);
	}
	
	file f;
	if(f.open("logs\\help_pleads.txt","a")>=0)
	{
		string date=TimeToString(player);
		
		string type;
		if(player.Quest[(703)]==(0))
		type="Старт";
		else if(player.Quest[(703)]==(1))
		type="Прикл.";
		else if(player.Quest[(703)]==(2))
		type="Выжив.";
		else if(player.Quest[(703)]==(3))
		type="Аркада";
		else if(player.Quest[(703)]==(4))
		type="Тест";
		else
		type="ошибка";
		f.writeString(date+"\t"+type+"\t"+player.Id+"\t"+GetPlayerName(player.Id)+"\t"+"\t"+param3+"\n");
		f.close();
	}
	else
	Log("can't open!");
}

void read_help(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	file f;
	if(f.open("logs\\help_pleads.txt","r")>=0)
	{
		string word="";
		uint pos=0;
		f.setPos(0);
		while(!f.isEndOfFile())
		{
			pos=f.getPos();
			f.readLine(word);
			player.Say((11),word);
		}
		f.close();
	}
	else
	Log("can't open!");
}

class Poll
{
	uint Id;
	uint InitiatorId;
	string Question;
	uint8 AnsNum;
	string[]Answers;
	uint16[]Votes;
	
	Poll()
	{
		Id=0;
		InitiatorId=0;
		AnsNum=0;
	}
	
	Poll@Set(uint id,uint initiatorId,string&question)
	{
		Id=id;
		InitiatorId=initiatorId;
		Question=question;
		return this;
	}
	Poll@Add(string&answer)
	{
		AnsNum++;
		Answers.insertLast(answer);
		Votes.insertLast(0);
		return this;
	}
	void Vote(uint num)
	{
		if(num>=AnsNum)
		return;
		Votes[num]+=1;
	}
}

Poll@[]polls;
uint poll_lastId=0;

void _poll(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(param3 is null||param3.length()<10)
	return;
	
	string@[]@parts=splitEx(param3,"@");
	
	if(parts is null||parts.length()<2||parts.length()>6||parts[0]is null||parts[1]is null)
	return; 
	
	Poll@poll=Poll().Set(poll_lastId++,player.Id,parts[0]);
	
	for(uint i=1,j=parts.length();i<j;i++)
	{
		if(parts[i]is null)
		continue;
		poll.Add(parts[i]);
	}
	polls.insertLast(@poll);
	
	Critter@[]crs;
	GetAllPlayers(crs);
	
	string str="|0xFFFF0000 # |0xFFBB33CC Началось голосование. |0xFFFF0000 #";
	
	for(uint i=0,j=crs.length();i<j;i++)
	{
		if(crs[i]is null)
		continue;
		
		crs[i].Say((11),str);
		crs[i].StatBase[(93)]=poll.Id;
		crs[i].ShowScreen((2),poll.AnsNum,"answer_poll");
		crs[i].Say((18),poll.Question);
		for(uint k=0;k<poll.AnsNum;k++)
		{
			crs[i].Say((19+(k)),poll.Answers[k]);
		}
	}
	
	player.Say((11),"Poll Id: "+poll.Id);
}

Poll@GetPoll(uint8 num)
{
	Poll@poll=null;
	for(uint i=0;i<polls.length();i++)
	{
		if(polls[i]is null or polls[i].Id!=num)
		continue;
		@poll=polls[i];
	}
	return poll;
}

void answer_poll(Critter&cr,uint answerI,string&answerS)
{
	uint id=cr.Stat[(93)];
	Poll@poll=GetPoll(uint8(id));
	if(poll is null or poll.AnsNum<=answerI)
	return;
	
	poll.Votes[answerI]+=1;
	
	Critter@gm=GetCritter(poll.InitiatorId);
	
	if(@gm!=null)
	{
		gm.Say((11),"Игрок "+GetPlayerName(cr.Id)+"("+cr.Id+") выбрал вариант "+answerI);
	}
	cr.StatBase[(93)]=-1;
}

void poll_check(Critter&player,int param0,int param1,int param2)
{
	Poll@poll=GetPoll(uint8(param0));
	if(poll is null)
	{
		player.Say((11),"Голосование не найдено.");
		return;
	}
	
	player.Say((11),"Голосование #"+param0+": "+poll.Question);
	for(uint i=0;i<poll.AnsNum;i++)
	{
		player.Say((11),i+") "+poll.Answers[i]+" - "+poll.Votes[i]);
	}
}

void poll_end(Critter&player,int param0,int param1,int param2)
{
	Poll@poll=GetPoll(uint8(param0));
	if(poll is null)
	{
		player.Say((11),"Голосование не найдено.");
		return;
	}
	
	Critter@[]crs;
	
	if(param1>0)
	{
		crs.resize(1);
		@crs[0]=player;
	}
	else
	GetAllPlayers(crs);
	
	string str="Голосование #"+param0+": \""+poll.Question+"\" закончено.";
	string[]str0(poll.AnsNum);
	
	for(uint i=0;i<poll.AnsNum;i++)
	{
		str0[i]=i+") "+poll.Answers[i]+" - "+poll.Votes[i];
	}
	
	for(uint j=0,k=crs.length();j<k;j++)
	{
		if(crs[j]is null)
		continue;
		
		crs[j].Say((11),str);
		for(uint i=0;i<poll.AnsNum;i++)
		{
			crs[j].Say((11),str0[i]);
		}
	}
	
	@polls[poll.Id]=null;
} 

void _private(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(param0<1)
	return;
	Critter@cr=GetCritter(param0);
	if(cr is null or cr.IsNpc())
	{
		player.Say((11),"Игрок не найден.");
		return;
	}
	
	string str="|0xFFFF0000 <|0xFFFFFF00 "+((cr.GetAccess()>(1))?GetPlayerName(player.Id):((player.GetAccess()==(3))?"admin":"gm"))+"|0xFFFF0000 > |0xFFCC33AA "+param3;
	
	cr.Say((11),str);
	player.Say((11),"Отправлено.");
}

void GM_name(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(param0<1)
	return;
	player.Say((11),"Id: "+param0+" Login: "+GetPlayerName(param0));
}

void name(Critter&player,int param0,int param1,int param2)
{
	if(param0<1)
	return;
	player.Say((11),"Id: "+param0+" Login: "+GetPlayerName(param0));
}

void GM_showVal(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	showVal(player,param0,param1,param2);
}

void showVal(Critter&player,int param0,int param1,int param2)
{
	if(param0<1)return;
	
	Item@item=GetItem(param0);
	if(@item is null)return;
	
	player.Say((11),"ItemId: "+item.Id);
	player.Say((11),"Val0: "+item.Val0);
	player.Say((11),"Val1: "+item.Val1);
	player.Say((11),"Val2: "+item.Val2);
	player.Say((11),"Val3: "+item.Val3);
	player.Say((11),"Val4: "+item.Val4);
	player.Say((11),"Val5: "+item.Val5);
	player.Say((11),"Val6: "+item.Val6);
	player.Say((11),"Val7: "+item.Val7);
	player.Say((11),"Val8: "+item.Val8);
	player.Say((11),"Val9: "+item.Val9);
}

void give(Critter&player,int param0,int param1,int param2)
{
	Critter@cr=GetCritter(param0);
	if(@cr is null)
	return;
	
	Item@item=GetItem(param1);
	if(@item is null)
	return;
	
	uint count=1;
	if(item.IsStackable())
	{
		count=item.GetCount();
		if(param2>0&&uint(param2)<count)
		count=param2;
	}
	MoveItem(item,count,cr);
}

void _gmlex(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(param0<1)
	return;
	Critter@cr=GetCritter(param0);
	if(@cr is null||cr.IsNpc())
	{
		player.Say((11),"Игрок не найден.");
		return;
	}
	
	cr.SetLexems(param3);
	player.Say((11),"Лексема присвоена.");
}

void _gmitemlex(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(param0<1)
	return;
	Item@item=GetItem(param0);
	if(!(@item!=null))
	{
		player.Say((11),"Игрок не найден.");
		return;
	}
	
	item.SetLexems(param3);
	player.Say((11),"Лексема присвоена.");
} 

void unsafe_ADVENTURER_PANNEL_CRITTER(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(player.IsPlayer())
	{
		player.StatBase[(90)]=param0;
		player.ShowScreen((2),7,"answer_ADVENTURER_PANNEL_CRITTER");
		player.Say((18),"Выберите предупреждение");
		player.Say((19+(0)),"сленг");
		player.Say((19+(1)),"повергейминг");
		player.Say((19+(2)),"выход из роли");
		player.Say((19+(3)),"мародерство");
		player.Say((19+(4)),"клептомания");
		player.Say((19+(5)),"метагейм");
		player.Say((19+(6)),"мультоводство");
	}
}

void answer_ADVENTURER_PANNEL_CRITTER(Critter&cr,uint answerI,string&answerS)
{
	Critter@target=GetCritter(cr.Stat[(90)]);
	if(@target is null||target.IsNpc())
	{
		cr.Say((11),"Игрок не найден.");
		return;
	}
	if(cr.Stat[(95)]>3)
	return;
	cr.StatBase[(95)]+=1;
	string plead;
	if(answerI==0)
	{
		target.ShowScreen((2),0,"unsafe_answer_NULL");
		target.Say((18),"НА СЕРВЕРЕ ЗАПЕРЩЕН СЛЕНГ И НЕИГРОВОЕ ОБЩЕНИЕ");
		plead=" - сленг";
	}
	else if(answerI==1)
	{
		target.ShowScreen((2),0,"unsafe_answer_NULL");
		target.Say((18),"НЕ СТРОЙТЕ ИЗ СЕБЯ РЕМБО, ПОМНИТЕ ОБ ИНСТИНКТЕ САМОСОХРАНЕНИЯ");
		plead=" - рембо";
	}
	else if(answerI==2)
	{
		target.ShowScreen((2),0,"unsafe_answer_NULL");
		target.Say((18),"ПРИДЕРЖИВАЙТЕСЬ СВОЕЙ ИГРОВОЙ РОЛИ");
		plead=" - несоответствие роли";
	}
	else if(answerI==3)
	{
		target.ShowScreen((2),0,"unsafe_answer_NULL");
		target.Say((18),"БЕЗСИСТЕМНОЕ ЛУТАНИЕ ТРУПОВ ЭТО МАРОДЕРСТВО, ОСТАНОВИТЕСЬ");
		plead=" - мародерство";
	}
	else if(answerI==4)
	{
		target.ShowScreen((2),0,"unsafe_answer_NULL");
		target.Say((18),"НЕ ШАРЬТЕСЬ ГДЕ ПОПАЛО, ПРИСТРЕЛЯТ ЗА ВОРОВСТВО");
		plead=" - клептомания";
	}
	else if(answerI==5)
	{
		target.ShowScreen((2),0,"unsafe_answer_NULL");
		target.Say((18),"ИСПОЛЬЗОВАНИЕ ИНФОРМАЦИИ ПОЛУЧЕННОЙ НЕИГРОВЫМ ПУТЕМ ЗАПРЕЩЕНО");
		plead=" - метагейм";
	}
	else if(answerI==6)
	{
		target.ShowScreen((2),0,"unsafe_answer_NULL");
		target.Say((18),"ЗАПРЕЩЕНО ВЗАИМОДЕЙСТВИЕ МЕЖДУ СВОИМИ ПЕРСОНАЖАМИ");
		plead=" - мультоводство";
	}
	if(plead!="")
	{
		cr.Say((11),"предупреждение выдано");
		Critter@[]crs;
		GetAllPlayers(crs);
		string str="жалоба от |0xFFFF0000 <|0xFFFFFF00 "+GetPlayerName(cr.Id)+"("+cr.Id+") на "+GetPlayerName(target.Id)+"("+target.Id+")|0xFFFF0000 > |0xFFBB33CC "+plead;
		for(uint i=0,j=crs.length();i<j;i++)
		{
			if(crs[i]is null or crs[i].GetAccess()<(2))
			continue;
			crs[i].Say((11),str);
		}
		file f;
		if(f.open("logs\\warnings.txt","a")>=0)
		{
			f.writeString("жалоба от "+GetPlayerName(cr.Id)+"\t"+"\t"+cr.Id+"\t"+" на "+GetPlayerName(target.Id)+"\t"+"\t"+target.Id+"\t"+plead+"\n");
			f.close();
		}
	}
}

void GM_PANNEL_SELF(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(player.GetAccess()>=(2))
	{
		player.ShowScreen((2),7,"answer_GM_PANNEL_SELF");
		player.Say((18),"ГМ ПАНЕЛЬ");
		player.Say((19+(0)),"Режимы себя");
		player.Say((19+(1)),"Режимы города");
		player.Say((19+(2)),"Смотреть Логи");
		player.Say((19+(3)),"По ID");
		player.Say((19+(4)),"Склад");
		player.Say((19+(5)),"Чарлисты");
		player.Say((19+(6)),"Телепорт");  
		
	}
}

void answer_GM_PANNEL_SELF(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		player.ShowScreen((2),6,"answer_GM_PANNEL_SELF_MYMODES");
		player.Say((18),"Выберите режимы");
		player.Say((19+(0)),"ред. как игрока");
		if(player.Mode[(527)]==0)
		player.Say((19+(1)),"+ неуязвимость");
		else
		player.Say((19+(1)),"- неуязвимость");
		if(player.Quest[(702)]==0)
		player.Say((19+(2)),"+ всевидение");
		else
		player.Say((19+(2)),"- всевидение");
		if(player.Mode[(514)]==0)
		player.Say((19+(3)),"+ nopvp");
		else
		player.Say((19+(3)),"- nopvp");
		player.Say((19+(4)),"обзор ID");
		player.Say((19+(5)),"назад");
	}
	if(answerI==1)
	{
		GameVar@Reg=GetGlobalVar((7344));
		player.ShowScreen((2),6,"answer_GM_PANNEL_SELF_TOWNMODES");
		player.Say((18),"Выберите режимы");
		player.Say((19+(0)),"воен положение");
		player.Say((19+(1)),"активность гвард");
		player.Say((19+(2)),"расизм");
		player.Say((19+(3)),"шлюз");
		if(Reg.GetValue()==0)
		player.Say((19+(4)),"закрыть регистрацию");
		else
		player.Say((19+(4)),"открыть регистрацию");
		player.Say((19+(5)),"назад");
	}
	if(answerI==2)
	{
		player.ShowScreen((2),11,"answer_GM_PANNEL_SELF_LOG");
		player.Say((18),"Что желаешь хозяин?");
		player.Say((19+(0)),"скачать help");
		player.Say((19+(1)),"скачать warn");
		player.Say((19+(2)),"скачать kill");
		player.Say((19+(3)),"скачать factions");
		player.Say((19+(4)),"скачать bans");
		player.Say((19+(5)),"скачать crims");
		if(player.GetAccess()>(2))
		player.Say((19+(9)),"очистить лог");
		player.Say((19+(10)),"назад");
	}
	if(answerI==3)
	{
		player.ShowScreen((2),7,"answer_GM_PANNEL_SELF_ID");
		player.Say((18),"Действия по ID");
		player.Say((19+(0)),"Режимы игры");
		player.Say((19+(1)),"Фракции/пропуски");
		player.Say((19+(2)),"Смотреть анкету");
		player.Say((19+(3)),"Инвентарь");
		player.Say((19+(4)),"Бан");
		player.Say((19+(5)),"Разбан");
		player.Say((19+(6)),"назад");
	}
	if(answerI==4)
	{
		player.ShowScreen((2),10,"answer_GM_PANNEL_SELF_VAULT");
		player.Say((18),"Склад");
		player.Say((19+(0)),"оружие");
		player.Say((19+(1)),"броня");
		player.Say((19+(2)),"патроны");
		player.Say((19+(3)),"инструменты");
		player.Say((19+(4)),"разное");
		player.Say((19+(5)),"+эквип");
		player.Say((19+(6)),"+патроны");
		player.Say((19+(7)),"+инструменты");
		player.Say((19+(8)),"социальное");
		player.Say((19+(9)),"назад");
	}
	if(answerI==5)
	{
		player.ShowScreen((2),6,"answer_GM_PANNEL_SELF_CHARLIST");
		player.Say((18),"Чарлисты");
		player.Say((19+(0)),"Скачать");
		player.Say((19+(1)),"Одобрить по ID");
		player.Say((19+(2)),"Отказать по ID");
		player.Say((19+(3)),"Бан по ID");
		player.Say((19+(4)),"Редактировать");
		player.Say((19+(5)),"назад");
	}
	if(answerI==6)
	{
		GMPreset@preset=GetPreset(player);
		if(@preset!is null)@preset.answer=@preset.teleport;
	}
	
	if(answerI==7)
	{
		Map@map=player.GetMap();
		uint16[]max_count={GetLocalVar((310),map.Id).GetValue(),
			GetLocalVar((311),map.GetProtoId()).GetValue(),
			GetLocalVar((312),map.Id).GetValue(),
			GetLocalVar((313),map.Id).GetValue(),
			GetLocalVar((314),map.Id).GetValue(),
			GetLocalVar((315),map.Id).GetValue(),
			GetLocalVar((316),map.Id).GetValue(),
			GetLocalVar((317),map.Id).GetValue(),
			GetLocalVar((318),map.Id).GetValue(),
			GetLocalVar((319),map.Id).GetValue(),
			GetLocalVar((320),map.Id).GetValue(),
			GetLocalVar((321),map.Id).GetValue(),
			GetLocalVar((322),map.Id).GetValue()};
		player.ShowScreen((2),13,"answer_GM_PANNEL_SELF_MAPSPAWN1");
		player.Say((18),"Спавны текущей карты:");
		player.Say((19+(0)),""+max_count[0]+" крысы");
		player.Say((19+(1)),""+max_count[1]+" мантисы");
		player.Say((19+(2)),""+max_count[2]+" муравьи");
		player.Say((19+(3)),""+max_count[3]+" свинокрыс");
		player.Say((19+(4)),""+max_count[4]+" кротокрысы");
		player.Say((19+(5)),""+max_count[5]+" кроты гризли");
		player.Say((19+(6)),""+max_count[6]+" кротокр мут");
		player.Say((19+(7)),""+max_count[7]+" гекко");
		player.Say((19+(8)),""+max_count[8]+" зол гекко");
		player.Say((19+(9)),""+max_count[9]+" волки");
		player.Say((19+(10)),""+max_count[10]+" м.скорп");
		player.Say((19+(11)),""+max_count[11]+" б.скорп");
		player.Say((19+(12)),""+max_count[12]+" растение");
	}
	if(answerI==8)
	{
		Map@map=player.GetMap();
		uint16[]max_count={GetLocalVar((323),map.Id).GetValue(),
			GetLocalVar((324),map.Id).GetValue(),
			GetLocalVar((325),map.Id).GetValue(),
			GetLocalVar((326),map.Id).GetValue(),
			GetLocalVar((327),map.Id).GetValue(),
			GetLocalVar((328),map.Id).GetValue(),
			GetLocalVar((329),map.Id).GetValue(),
			GetLocalVar((330),map.Id).GetValue(),
			GetLocalVar((335),map.Id).GetValue(),
			GetLocalVar((336),map.Id).GetValue(),
			GetLocalVar((337),map.Id).GetValue(),
			GetLocalVar((338),map.Id).GetValue(),
			GetLocalVar((339),map.Id).GetValue(),
			GetLocalVar((340),map.Id).GetValue(),
			GetLocalVar((341),map.Id).GetValue()};
		player.ShowScreen((2),12,"answer_GM_PANNEL_SELF_MAPSPAWN2");
		player.Say((18),"Спавны текущей карты:");
		player.Say((19+(0)),""+max_count[0]+" чужой");
		player.Say((19+(1)),""+max_count[1]+" м.коготь");
		player.Say((19+(2)),""+max_count[2]+" б.коготь");
		player.Say((19+(3)),""+max_count[3]+" сер.коготь");
		player.Say((19+(4)),""+max_count[4]+" огнегекко");
		player.Say((19+(5)),""+max_count[5]+" кентавр");
		player.Say((19+(6)),""+max_count[6]+" летатель");
		player.Say((19+(7)),""+max_count[7]+" болотник");
		player.Say((19+(8)),""+max_count[8]+" потрошитель");
		player.Say((19+(9)),""+max_count[9]+" ж.потрошитель");
		player.Say((19+(10)),""+max_count[10]+" бандит");
		player.Say((19+(11)),""+max_count[11]+" бандитка");
	}
	if(answerI==9)
	{
		Map@map=player.GetMap();
		uint16[]max_count={GetLocalVar((310),map.Id).GetValue(),
			GetLocalVar((311),map.Id).GetValue(),
			GetLocalVar((312),map.Id).GetValue(),
			GetLocalVar((313),map.Id).GetValue(),
			GetLocalVar((314),map.Id).GetValue(),
			GetLocalVar((315),map.Id).GetValue(),
			GetLocalVar((316),map.Id).GetValue(),
			GetLocalVar((317),map.Id).GetValue(),
			GetLocalVar((318),map.Id).GetValue(),
			GetLocalVar((319),map.Id).GetValue(),
			GetLocalVar((320),map.Id).GetValue(),
			GetLocalVar((321),map.Id).GetValue(),
			GetLocalVar((322),map.Id).GetValue(),
			GetLocalVar((323),map.Id).GetValue(),
			GetLocalVar((324),map.Id).GetValue(),
			GetLocalVar((325),map.Id).GetValue(),
			GetLocalVar((326),map.Id).GetValue(),
			GetLocalVar((327),map.Id).GetValue(),
			GetLocalVar((328),map.Id).GetValue(),
			GetLocalVar((329),map.Id).GetValue(),
			GetLocalVar((330),map.Id).GetValue(),
			GetLocalVar((335),map.Id).GetValue(),
			GetLocalVar((336),map.Id).GetValue(),
			GetLocalVar((337),map.Id).GetValue(),
			GetLocalVar((338),map.Id).GetValue(),
			GetLocalVar((339),map.Id).GetValue(),
			GetLocalVar((340),map.Id).GetValue(),
			GetLocalVar((341),map.Id).GetValue(),
			GetLocalVar((342),map.Id).GetValue(),
			GetLocalVar((343),map.Id).GetValue(),
			GetLocalVar((344),map.Id).GetValue(),
			GetLocalVar((345),map.Id).GetValue(),
			GetLocalVar((346),map.Id).GetValue(),
			GetLocalVar((347),map.Id).GetValue(),
			GetLocalVar((348),map.Id).GetValue(),
			GetLocalVar((349),map.Id).GetValue()};
		
		Critter@[]critters;
		for(uint i=0,j=max_count.length();i<j;i++)
		{
			map.GetCritters(310+i,(0x0F)|(0x20),critters);
			for(uint ii=0,jj=critters.length()-max_count[i];ii<jj;ii++)
			{
				DeleteNpc(critters[ii]);
			}
			critters.resize(0);
		}
	}
}

void answer_GM_PANNEL_SELF_MAPSPAWN1(Critter&player,uint answerI,string&answerS)
{
	player.StatBase[(90)]=answerI;
	player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_MAPSPAWN");
	player.Say((39),"количество");
}

void answer_GM_PANNEL_SELF_MAPSPAWN2(Critter&player,uint answerI,string&answerS)
{
	player.StatBase[(90)]=answerI+13;
	player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_MAPSPAWN");
	player.Say((39),"количество");
}

void ask_GM_PANNEL_SELF_MAPSPAWN(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		
		Map@map=player.GetMap();
		int var_type=player.Stat[(90)];
		switch(var_type)
		{
			case 0:GetLocalVar((310),map.Id)=(number);break;
			case 1:GetLocalVar((311),map.Id)=(number);break;
			case 2:GetLocalVar((312),map.Id)=(number);break;
			case 3:GetLocalVar((313),map.Id)=(number);break;
			case 4:GetLocalVar((314),map.Id)=(number);break;
			case 5:GetLocalVar((315),map.Id)=(number);break;
			case 6:GetLocalVar((316),map.Id)=(number);break;
			case 7:GetLocalVar((317),map.Id)=(number);break;
			case 8:GetLocalVar((318),map.Id)=(number);break;
			case 9:GetLocalVar((319),map.Id)=(number);break;
			case 10:GetLocalVar((320),map.Id)=(number);break;
			case 11:GetLocalVar((321),map.Id)=(number);break;
			case 12:GetLocalVar((322),map.Id)=(number);break;
			case 13:GetLocalVar((323),map.Id)=(number);break;
			case 14:GetLocalVar((324),map.Id)=(number);break;
			case 15:GetLocalVar((325),map.Id)=(number);break;
			case 16:GetLocalVar((326),map.Id)=(number);break;
			case 17:GetLocalVar((327),map.Id)=(number);break;
			case 18:GetLocalVar((328),map.Id)=(number);break;
			case 19:GetLocalVar((329),map.Id)=(number);break;
			case 20:GetLocalVar((330),map.Id)=(number);break;
			case 21:GetLocalVar((335),map.Id)=(number);break;
			case 22:GetLocalVar((336),map.Id)=(number);break;
			case 23:GetLocalVar((337),map.Id)=(number);break;
			case 24:GetLocalVar((338),map.Id)=(number);break;
			case 25:GetLocalVar((339),map.Id)=(number);break;
			case 26:GetLocalVar((340),map.Id)=(number);break;
			case 27:GetLocalVar((341),map.Id)=(number);break;
			case 28:GetLocalVar((342),map.Id)=(number);break;
			case 29:GetLocalVar((343),map.Id)=(number);break;
			case 30:GetLocalVar((344),map.Id)=(number);break;
			case 31:GetLocalVar((345),map.Id)=(number);break;
			case 32:GetLocalVar((346),map.Id)=(number);break;
			case 33:GetLocalVar((347),map.Id)=(number);break;
			case 34:GetLocalVar((348),map.Id)=(number);break;
			case 35:GetLocalVar((349),map.Id)=(number);break;
		}
		
		if(var_type<=12)
		{
			uint16[]max_count=
			{
				GetLocalVar((310),map.Id).GetValue(),
				GetLocalVar((311),map.Id).GetValue(),
				GetLocalVar((312),map.Id).GetValue(),
				GetLocalVar((313),map.Id).GetValue(),
				GetLocalVar((314),map.Id).GetValue(),
				GetLocalVar((315),map.Id).GetValue(),
				GetLocalVar((316),map.Id).GetValue(),
				GetLocalVar((317),map.Id).GetValue(),
				GetLocalVar((318),map.Id).GetValue(),
				GetLocalVar((319),map.Id).GetValue(),
				GetLocalVar((320),map.Id).GetValue(),
				GetLocalVar((321),map.Id).GetValue(),
				GetLocalVar((322),map.Id).GetValue()
			};
			player.ShowScreen((2),12,"answer_GM_PANNEL_SELF_MAPSPAWN1");
			player.Say((18),"Спавны текущей карты:");
			player.Say((19+(0)),""+max_count[0]+" крысы");
			player.Say((19+(1)),""+max_count[1]+" мантисы");
			player.Say((19+(2)),""+max_count[2]+" муравьи");
			player.Say((19+(3)),""+max_count[3]+" кротокрысы");
			player.Say((19+(4)),""+max_count[4]+" кроты гризли");
			player.Say((19+(5)),""+max_count[5]+" кротокр мут");
			player.Say((19+(6)),""+max_count[6]+" гекко");
			player.Say((19+(7)),""+max_count[7]+" зол гекко");
			player.Say((19+(8)),""+max_count[8]+" волки");
			player.Say((19+(9)),""+max_count[9]+" м.скорп");
			player.Say((19+(10)),""+max_count[10]+" б.скорп");
			player.Say((19+(11)),""+max_count[11]+" растение");
		}
		else
		{
			uint16[]max_count={GetLocalVar((323),map.Id).GetValue(),
				GetLocalVar((324),map.Id).GetValue(),
				GetLocalVar((325),map.Id).GetValue(),
				GetLocalVar((326),map.Id).GetValue(),
				GetLocalVar((327),map.Id).GetValue(),
				GetLocalVar((328),map.Id).GetValue(),
				GetLocalVar((329),map.Id).GetValue(),
				GetLocalVar((330),map.Id).GetValue(),
				GetLocalVar((335),map.Id).GetValue(),
				GetLocalVar((336),map.Id).GetValue(),
				GetLocalVar((337),map.Id).GetValue(),
				GetLocalVar((338),map.Id).GetValue(),
				GetLocalVar((339),map.Id).GetValue(),
				GetLocalVar((340),map.Id).GetValue(),
				GetLocalVar((341),map.Id).GetValue()};
			player.ShowScreen((2),12,"answer_GM_PANNEL_SELF_MAPSPAWN2");
			player.Say((18),"Спавны текущей карты:");
			player.Say((19+(0)),""+max_count[0]+" чужой");
			player.Say((19+(1)),""+max_count[1]+" м.коготь");
			player.Say((19+(2)),""+max_count[2]+" б.коготь");
			player.Say((19+(3)),""+max_count[3]+" сер.коготь");
			player.Say((19+(4)),""+max_count[4]+" огнегекко");
			player.Say((19+(5)),""+max_count[5]+" кентавр");
			player.Say((19+(6)),""+max_count[6]+" летатель");
			player.Say((19+(7)),""+max_count[7]+" болотник");
			player.Say((19+(8)),""+max_count[8]+" потрошитель");
			player.Say((19+(9)),""+max_count[9]+" ж.потрошитель");
			player.Say((19+(10)),""+max_count[10]+" бандит");
			player.Say((19+(11)),""+max_count[11]+" бандитка");
		}
	}
}

void answer_GM_PANNEL_SELF_CHARLIST(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		GameVar@TotalPlayers=GetGlobalVar((4));
		for(uint i=1;i<=TotalPlayers;i++)
		{
			GameVar@request=GetLocalVar((6101),i);
			GameVar@activation=GetLocalVar((6100),i);
			if(activation.GetValue()==-2)
			{
				file f;
				if(f.open("adventurers\\"+i+".txt","r")>=0)
				{
					string word="";
					uint pos=0;
					uint line=0;
					f.setPos(0);
					while(!f.isEndOfFile())
					{
						pos=f.getPos();
						if(pos==0)
						{
							f.readLine(word);
							if(word.length()>0)
							player.RunClientScript("client_main@loger",0,6,i,word,null);
						}
						else
						{
							line+=1;
							f.readLine(word);
							player.RunClientScript("client_main@loger",line,6,i,word,null);
						}
					}
					f.close();
				}
			}
			else if(activation.GetValue()==-1)
			{
				file f;
				if(f.open("adventurers\\"+i+".txt","r")>=0)
				{
					string word="";
					uint pos=0;
					uint line=0;
					f.setPos(0);
					while(!f.isEndOfFile())
					{
						pos=f.getPos();
						if(pos==0)
						{
							f.readLine(word);
							if(word.length()>0)
							player.RunClientScript("client_main@loger",0,7,i,word,null);
						}
						else
						{
							line+=1;
							f.readLine(word);
							player.RunClientScript("client_main@loger",line,7,i,word,null);
						}
					}
					f.close();
				}
			}
			else
			{
				file f;
				if(f.open("adventurers\\"+i+".txt","r")>=0)
				{
					string word="";
					uint pos=0;
					uint line=0;
					f.setPos(0);
					while(!f.isEndOfFile())
					{
						pos=f.getPos();
						if(pos==0)
						{
							f.readLine(word);
							if(word.length()>0)
							player.RunClientScript("client_main@loger",0,5,i,word,null);
						}
						else
						{
							line+=1;
							f.readLine(word);
							player.RunClientScript("client_main@loger",line,5,i,word,null);
						}
					}
					f.close();
				}
			}
		}
		player.Say((11),"Чарлисты записаны.");
	}
	if(answerI==1)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_CHARLIST_aprove");
		player.Say((39),"Ид на одобрение");
	}
	if(answerI==2)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_CHARLIST_disaprove");
		player.Say((39),"Ид на отказ");
	}
	if(answerI==3)
	{
		player.Say((11),"в разработке.");
	}
	if(answerI==4)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_CHARLIST_redact");
		player.Say((39),"Ид на редактирование");
	}
	if(answerI==5)
	{
		GM_PANNEL_SELF(player,0,0,0,null,null);
	}
}

void ask_GM_PANNEL_SELF_CHARLIST_redact(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		if(!(@GetCritter(number)!=null))
		player.Say((11),"персонажа "+GetPlayerName(number)+"  "+number+" нет онлайн ");
		player.StatBase[(91)]=number;
		GameVar@request=GetLocalVar((6101),number);
		GameVar@activation=GetLocalVar((6100),number);
		if(activation.GetValue()==-2)
		player.Say((11),"Ранее был одобрен.");
		else if(activation.GetValue()==-1)
		{
			player.Say((11),"Уже было отказан.");
			return;
		}
		player.ShowScreen((2),3,"answer_GM_PANNEL_SELF_CHARLIST_redact");
		player.Say((18),"Выберите действие с чарсетом номер "+request.GetValue()+" на персонажа "+GetPlayerName(number)+"  "+number);
		player.Say((19+(0)),"Считать чарсет");
		player.Say((19+(1)),"Записать чарсет");
		player.Say((19+(2)),"Перейти к одобрению");
	}
}

void answer_GM_PANNEL_SELF_CHARLIST_redact(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		file f;
		if(f.open("adventurers\\"+player.Stat[(91)]+".txt","r")>=0)
		{
			Item@[]items;
			player.GetItems((0),items);
			player.GetItems((1),items);
			player.GetItems((2),items);
			DeleteItems(items);
			
			Item@item;
			string text="";
			uint pos=0;
			uint line=0;
			int number=0;
			int count=0;
			bool isCount=true;
			f.setPos(0);
			while(!f.isEndOfFile())
			{
				line++;
				f.readLine(text);
				text.resize(text.length()-1);
				StrToInt(text,number);
				if(line==2)
				{
					if(text=="Человек")player.ChangeCrType(69);
					else if(text=="Супермутант")player.ChangeCrType(21);
					else if(text=="Гуль")player.ChangeCrType(28);
				}
				else if(line>=6&&line<=12)
				{
					player.ParamBase[line-6]=number;
				}
				else if(line>=14&&line<=31)
				{
					player.ParamBase[line+186]=number;
				}
				else if(line>=34)
				{
					Log("line="+line+" , num="+number);
					if(number==12345)break;
					if(isCount)
					{
						count=number;
						isCount=false;
					}
					else
					{
						@item=player.AddItem(number,count);
						if(item.AmmoCount!=0)item.AmmoCount=0;
						isCount=true;
					}
				}
			}
			f.close();
			player.Say((11),"Чарсет скачан.");
		}
		else return;
	}
	if(answerI==1)
	{
		string date=TimeToString(player);
		string race="";
		if(player.Stat[(67)]==(4))
		race="Гуль";
		else if(player.Stat[(67)]==(3))
		race="Супермутант";
		else
		race="Человек";
		string pass="";
		Critter@critter=GetCritter(player.Stat[(91)]);
		if(critter.Quest[(705)]==0)
		pass="чужак";
		else if(critter.Quest[(705)]==11)
		pass="гость";
		else if(critter.Quest[(705)]==12)
		pass="гражданин";
		GameVar@request=GetLocalVar((6101),player.Stat[(91)]);
		file f;
		if(f.open("adventurers\\"+player.Id+".txt","w")>=0)
		{
			f.writeString(request.GetValue()+"\n"+
			race+"  -  "+pass+"\n"+
			date+"\n"+
			GetPlayerName(player.Id)+"\n"+
			"\n"+
			player.StatBase[(0)]+"\n"+
			player.StatBase[(1)]+"\n"+
			player.StatBase[(2)]+"\n"+
			player.StatBase[(3)]+"\n"+
			player.StatBase[(4)]+"\n"+
			player.StatBase[(5)]+"\n"+
			player.StatBase[(6)]+"\n"+"\n"+
			player.SkillBase[(200)]+"\n"+
			player.SkillBase[(201)]+"\n"+
			player.SkillBase[(202)]+"\n"+
			player.SkillBase[(203)]+"\n"+
			player.SkillBase[(204)]+"\n"+
			player.SkillBase[(205)]+"\n"+
			player.SkillBase[(206)]+"\n"+
			player.SkillBase[(207)]+"\n"+
			player.SkillBase[(208)]+"\n"+
			player.SkillBase[(209)]+"\n"+
			player.SkillBase[(210)]+"\n"+
			player.SkillBase[(211)]+"\n"+
			player.SkillBase[(212)]+"\n"+
			player.SkillBase[(213)]+"\n"+
			player.SkillBase[(214)]+"\n"+
			player.SkillBase[(215)]+"\n"+
			player.SkillBase[(216)]+"\n"+
			player.SkillBase[(217)]+"\n"+"\n"+"Инвентарь"+"\n");
			
			Item@[]items;
			player.GetItems((3),items);
			player.GetItems((1),items);
			player.GetItems((2),items);
			player.GetItems((0),items);
			for(uint i=0;i<items.length();i++)
			{
				f.writeString(items[i].GetCount()+"\n");
				f.writeString(items[i].GetProtoId()+"\n");
			}
			f.writeString(12345+"\n");
			f.close();
			player.Say((11),"Чарсет записан.");
		}
	}
	if(answerI==2)
	ask_GM_PANNEL_SELF_CHARLIST_aprove(player,answerI,""+player.Stat[(91)]);
}

void ask_GM_PANNEL_SELF_CHARLIST_disaprove(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		if(!(@GetCritter(number)!=null))
		player.Say((11),"персонажа "+GetPlayerName(number)+"  "+number+" нет онлайн ");
		player.StatBase[(91)]=number;
		GameVar@request=GetLocalVar((6101),number);
		GameVar@activation=GetLocalVar((6100),number);
		if(activation.GetValue()==-2)
		player.Say((11),"Ранее был одобрен.");
		else if(activation.GetValue()==-1)
		{
			player.Say((11),"Уже было отказан.");
			return;
		}
		player.ShowScreen((2),1,"answer_GM_PANNEL_SELF_CHARLIST_disaprove");
		player.Say((18),"Подтвердите отказ запроса номер "+request.GetValue()+" на чарлиста "+GetPlayerName(number)+"  "+number);
		player.Say((19+(0)),"Отказ подтверждаю");
	}
}

void answer_GM_PANNEL_SELF_CHARLIST_disaprove(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		GameVar@activation=GetLocalVar((6100),player.Stat[(91)]);
		activation=-1;
		player.Say((11),"Чарсету персонажа "+GetPlayerName(player.Stat[(91)])+" отказанно в активации.");
	}
}

void ask_GM_PANNEL_SELF_CHARLIST_aprove(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int id=0;
		StrToInt(answerS,id);
		Critter@hero=GetCritter(id);
		GameVar@activation=GetLocalVar((6100),id);
		
		player.StatBase[(91)]=id;
		GameVar@request=GetLocalVar((6101),id);
		
		string description="Подтвердите запрос номер "+request.GetValue()+" на активацию чарлиста "+GetPlayerName(id)+"  "+id+", выбран пропуск = ";
		switch(activation.GetValue())
		{
			case 0:
			{
				player.Say((11),"Персонаж "+GetPlayerName(id)+" ещё не подтвердил анкету!");
				if(@hero!is null)
				hero.Say((11),"ГМ попытался вас активировать до того, как вы подтвердили анкету. Нажмите 'подтведить' в разговоре с гидом активации!");
				return;
			}
			
			case-2:
			{
				player.Say((11),"Уже активирован.");
				return;
			}
			
			case-1:
			{
				player.Say((11),"Уже отказанно.");
				return;
			}
			
			case 1:description+="чужак";break;
			case 12:description+="гость";break;
			case 13:description+="гражданин";break;
			default:break;
		}
		
		if(@hero is null)
		description+=". Игрок оффлайн";
		
		player.ShowScreen((2),@hero is null?1:5,"answer_GM_PANNEL_SELF_CHARLIST_aprove");
		player.Say((18),description);
		player.Say((19+(0)),"Активировать");
		if(@hero!is null)
		{
			player.Say((19+(1)),"Актив<чужак>");
			player.Say((19+(2)),"Актив<гость>");
			player.Say((19+(3)),"Актив<гражданин>");
			player.Say((19+(4)),"Актив<выживалец>");
		}
	}
}

void answer_GM_PANNEL_SELF_CHARLIST_aprove(Critter&player,uint answerI,string&answerS)
{
	uint id=player.Stat[(91)];
	string name=GetPlayerName(id);
	Critter@critter=GetCritter(id);
	if(@critter is null)
	player.Say((11),"Игрок не существует, либо оффлайн");
	
	switch(answerI)
	{
		case 1:critter.QuestBase[(705)]=0;break;
		case 2:critter.QuestBase[(705)]=11;break;
		case 3:critter.QuestBase[(705)]=12;break;
		case 4:critter.QuestBase[(705)]=13;break;
		default:break;
	}
	GetLocalVar((6100),id)=-2;
	player.Say((11),"Чарсет персонажа "+name+" одобрен.");
	Log_GM(player,id,(1),answerI,answerI==0?critter.Quest[(705)]:0,0);
	file f;
	if(f.open("adventurers\\"+id+".txt","a")>=0)
	{
		f.writeString("12345\n"+"\n"+GetPlayerName(player.Id)+"\n");
		f.close();
	}
	ShowInputBoxScreen(player,"gm@unsafe_CharsetComment#Коммент",0,(0x00000001));
}

void unsafe_CharsetComment(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(@param3!is null&&param3.length()!=0)
	{
		file f;
		if(f.open("adventurers\\"+player.Stat[(91)]+".txt","a")>=0)
		{
			f.writeString("-------------------------------------------------------- \n"+param3+"\n"+"\n");
			f.close();
		}
	}
	Critter@critter=GetCritter(player.Stat[(91)]);
	if((@critter!=null))
	critter.Say((11),"ГМ одобрил вашу анкету. Кликните на Гида что бы выбрать стартовую локацию.");
}

void answer_GM_PANNEL_SELF_VAULT(Critter&player,uint answerI,string&answerS)
{
	if(answerI==9)
	{
		GM_PANNEL_SELF(player,0,0,0,null,null);
	}
	else OpenCrate(player,answerI+1);
}

void answer_GM_PANNEL_SELF_ID(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		player.ShowScreen((2),5,"answer_GM_PANNEL_SELF_ID_MODES");
		player.Say((18),"Выберете назначаемый режим");
		player.Say((19+(0)),"0 старт");
		player.Say((19+(1)),"1 приключенец");
		player.Say((19+(2)),"2 выживание");
		player.Say((19+(3)),"3 аркада");
		player.Say((19+(4)),"4 тест");
	}
	if(answerI==1)
	{
		player.ShowScreen((2),AnswerIdFactions::CountAnswer,"answer_GM_PANNEL_SELF_ID_FACTIONS");
		player.Say((18),"Выберете назначаемый режим");
		player.Say((19+(AnswerIdFactions::NoFaction)),"0 - без фракции");
		player.Say((19+(AnswerIdFactions::Administration)),"1 - администрация");
		player.Say((19+(AnswerIdFactions::Cop)),"2 - полиция");
		player.Say((19+(AnswerIdFactions::Mafia)),"3 - мафия");
		player.Say((19+(AnswerIdFactions::Mutant)),"4 - мутанты");
		player.Say((19+(AnswerIdFactions::Fort)),"5 - форт");
		player.Say((19+(AnswerIdFactions::Raider)),"6 - рейдеры");
		player.Say((19+(AnswerIdFactions::Sheriff)),"7 - Шериф");
		player.Say((19+(AnswerIdFactions::Mayor)),"8 - Мэр");
		player.Say((19+(AnswerIdFactions::Strange)),"0 - чужак");
		player.Say((19+(AnswerIdFactions::TimeGuest)),"1 - временный гость");
		player.Say((19+(AnswerIdFactions::Guest)),"2 - гость");
		player.Say((19+(AnswerIdFactions::Citizen)),"3 - гражданин");
		player.Say((19+(AnswerIdFactions::RichCitizen)),"4 - богатый гражданин");
		player.Say((19+(AnswerIdFactions::Outcast)),"10 - изгой");
	}
	if(answerI==2)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_CHARLIST");
		player.Say((39),"Введите Ид");
	}
	if(answerI==3)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_INVENTORY");
		player.Say((39),"Введите Ид");
	}
	if(answerI==4)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_BAN");
		player.Say((39),"Бан по Ид");
	}
	if(answerI==5)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_UNBAN");
		player.Say((39),"РазБан по Ид");
	}
	if(answerI==6)
	{
		GM_PANNEL_SELF(player,0,0,0,null,null);
	}
}

void ask_GM_PANNEL_SELF_ID_BAN(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		if(number<=0)
		{
			player.Say((11),"неверное значение");
			return;
		}
		if(!(@GetCritter(number)!=null))
		player.Say((11),"персонажа "+GetPlayerName(number)+"  "+number+" нет онлайн ");
		player.StatBase[(91)]=number;
		
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_BAN_TIME");
		player.Say((39),"на Часов");
	}
}

void ask_GM_PANNEL_SELF_ID_BAN_TIME(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int crId=player.Stat[(91)];
		int number=0;
		StrToInt(answerS,number);
		if(number<=0)
		{
			player.Say((11),"неверное значение");
			return;
		}
		BanId(player,crId,number,0);
		if((@GetCritter(crId)!=null))
		KickId(player,crId,0,0);
		player.Say((11),"персонаж "+GetPlayerName(crId)+"("+crId+")"+" заблокирован на "+number+" часов");
	}
}

void ask_GM_PANNEL_SELF_ID_UNBAN(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		if(number<=0)
		{
			player.Say((11),"неверное значение");
			return;
		}
		if(!(@GetCritter(number)!=null))
		player.Say((11),"персонажа "+GetPlayerName(number)+"  "+number+" нет онлайн ");
		UnbanId(player,number,0,0);
		player.Say((11),"персонаж "+GetPlayerName(number)+"("+number+")"+" разблокирован");
	}
}

void ask_GM_PANNEL_SELF_ID_INVENTORY(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		if(number<=0)
		{
			player.Say((11),"неверное значение");
			return;
		}
		if(!(@GetCritter(number)!=null))
		{
			player.Say((11),"персонажа "+GetPlayerName(number)+"  "+number+" нет онлайн ");
			return;
		}
		player.ShowContainer((GetCritter(number)),null,(8));
	}
}

void ask_GM_PANNEL_SELF_ID_CHARLIST(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		if(number<=0)
		{
			player.Say((11),"неверное значение");
			return;
		}
		if(!(@GetCritter(number)!=null))
		player.Say((11),"персонажа "+GetPlayerName(number)+"  "+number+" нет онлайн ");
		file f;
		if(f.open("adventurers\\"+number+".txt","r")>=0)
		{
			string word="";
			uint pos=0;
			f.setPos(0);
			while(!f.isEndOfFile())
			{
				pos=f.getPos();
				if(pos==0)
				{
					f.readLine(word);
					player.RunClientScript("client_main@loger",0,5,number,word,null);
				}
				else
				{
					f.readLine(word);
					player.RunClientScript("client_main@loger",1,5,number,word,null);
				}
			}
			player.Say((11),"чарлист игрока "+GetPlayerName(number)+"  "+number+" записан");
			f.close();
		}
		else
		Log("can't open!");
	}
}

void answer_GM_PANNEL_SELF_ID_MODES(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		player.StatBase[(91)]=0;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_MODES");
		player.Say((39),"Ид - старт фракц");
	}
	if(answerI==1)
	{
		player.StatBase[(91)]=1;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_MODES");
		player.Say((39),"Ид - приключенец");
	}
	if(answerI==2)
	{
		player.StatBase[(91)]=2;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_MODES");
		player.Say((39),"Ид - выживание");
	}
	if(answerI==3)
	{
		player.StatBase[(91)]=3;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_MODES");
		player.Say((39),"Ид - аркада");
	}
	if(answerI==4)
	{
		player.StatBase[(91)]=4;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_SELF_ID_MODES");
		player.Say((39),"Ид - тест");
	}
}

void ask_GM_PANNEL_SELF_ID_MODES(Critter&player,uint answerI,string&answerS)
{
	int mode=player.Stat[(91)];
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		Critter@target=GetCritter(number);
		if(!(@target!=null))
		{
			player.Say((11),"персонажа "+number+" нет онлайн ");
			return;
		}
		target.StatBase[(703)]=mode;
		player.Say((11),"вы изменили игровой режим игрока "+GetPlayerName(player.Id)+" с номером "+number+" на "+mode);
		Log_factions(player,number,0,mode,null,null);
		
		player.ShowScreen((2),5,"answer_GM_PANNEL_SELF_ID_MODES");
		player.Say((18),"Выберете назначаемый режим");
		player.Say((19+(0)),"0 старт");
		player.Say((19+(1)),"1 приключенец");
		player.Say((19+(2)),"2 выживание");
		player.Say((19+(3)),"3 аркада");
		player.Say((19+(4)),"4 тест");
	}
}

enum AnswerIdFactions
{
	NoFaction,
	Administration,
	Cop,
	Mafia,
	Mutant,
	Fort,
	Raider,
	Sheriff,
	Mayor,
	
	Strange,
	TimeGuest,
	Guest,
	Citizen,
	RichCitizen,
	Outcast,
	
	CountAnswer
}

void answer_GM_PANNEL_SELF_ID_FACTIONS(Critter&player,uint answerI,string&answerS)
{
	player.ShowScreen((5),0,"ask_GM_PANNEL_SELF_ID_FACTIONS");
	switch(answerI)
	{
		case AnswerIdFactions::NoFaction:
		{
			player.StatBase[(91)]=0;
			player.Say((39),"Ид - убрать фракции");
		}break;
		
		case AnswerIdFactions::Administration:
		{
			player.StatBase[(91)]=1;
			player.Say((39),"Ид - в администрацию");
		}break;
		
		case AnswerIdFactions::Cop:
		{
			player.StatBase[(91)]=2;
			player.Say((39),"Ид - в полицию");
		}break;
		
		case AnswerIdFactions::Mafia:
		{
			player.StatBase[(91)]=3;
			player.Say((39),"Ид - в мафию");
		}break;
		
		case AnswerIdFactions::Mutant:
		{
			player.StatBase[(91)]=4;
			player.Say((39),"Ид - в мутанты");
		}break;
		
		case AnswerIdFactions::Fort:
		{
			player.StatBase[(91)]=5;
			player.Say((39),"Ид - в форт");
		}break;
		
		case AnswerIdFactions::Raider:
		{
			player.StatBase[(91)]=6;
			player.Say((39),"Ид - в рейдеры");
		}break;
		
		case AnswerIdFactions::Sheriff:
		{
			player.StatBase[(91)]=7;
			player.Say((39),"Ид - в шерифы");
		}break;
		
		case AnswerIdFactions::Mayor:
		{
			player.StatBase[(91)]=8;
			player.Say((39),"Ид - в мэры");
		}break;
		
		case AnswerIdFactions::Strange:
		{
			player.StatBase[(91)]=10;
			player.Say((39),"Ид - чужак");
		}break;
		
		case AnswerIdFactions::TimeGuest:
		{
			player.StatBase[(91)]=11;
			player.Say((39),"Ид - врем.гость");
		}break;
		
		case AnswerIdFactions::Guest:
		{
			player.StatBase[(91)]=12;
			player.Say((39),"Ид - гость");
		}break;
		
		case AnswerIdFactions::Citizen:
		{
			player.StatBase[(91)]=13;
			player.Say((39),"Ид - гражданин");
		}break;
		
		case AnswerIdFactions::RichCitizen:
		{
			player.StatBase[(91)]=14;
			player.Say((39),"Ид - богатый");
		}break;
		
		case AnswerIdFactions::Outcast:
		{
			player.StatBase[(91)]=20;
			player.Say((39),"Ид - изгой");
		}break;
		
		default:
		{
			player.StatBase[(91)]=-1;
			player.Say((39),"Ид - Error");
		}break;
	}
}

void ask_GM_PANNEL_SELF_ID_FACTIONS(Critter&player,uint answerI,string&answerS)
{
	int mode=player.Stat[(91)];
	if(answerS.length()>0)
	{
		if(mode!=-1)
		{
			int id=0;
			StrToInt(answerS,id);
			Critter@target=GetCritter(id);
			string name=GetPlayerName(id);
			if(mode<10)
			{
				if(mode==AnswerIdFactions::Mayor)
				target.AddItem(913,1);
				else if(mode==AnswerIdFactions::Sheriff)
				target.AddItem(1455,1);
				
				target.QuestBase[(704)]=mode;
				player.Say((11),"вы изменили фракцию игрока "+name+" с номером "+id+" на "+mode);
				Log_factions(player,id,2,mode,null,null);
			}
			else
			{
				target.QuestBase[(705)]=(mode-10);
				player.Say((11),"вы изменили пропуск игрока "+name+" с номером "+id+" на "+mode);
				Log_factions(player,id,1,mode,null,null);
			}
		}
		
		player.ShowScreen((2),AnswerIdFactions::CountAnswer,"answer_GM_PANNEL_SELF_ID_FACTIONS");
		player.Say((18),"Выберете назначаемый режим");
		player.Say((19+(AnswerIdFactions::NoFaction)),"0 - без фракции");
		player.Say((19+(AnswerIdFactions::Administration)),"1 - администрация");
		player.Say((19+(AnswerIdFactions::Cop)),"2 - полиция");
		player.Say((19+(AnswerIdFactions::Mafia)),"3 - мафия");
		player.Say((19+(AnswerIdFactions::Mutant)),"4 - мутанты");
		player.Say((19+(AnswerIdFactions::Fort)),"5 - форт");
		player.Say((19+(AnswerIdFactions::Raider)),"6 - рейдеры");
		player.Say((19+(AnswerIdFactions::Sheriff)),"7 - Шериф");
		player.Say((19+(AnswerIdFactions::Mayor)),"8 - Мэр");
		player.Say((19+(AnswerIdFactions::Strange)),"0 - чужак");
		player.Say((19+(AnswerIdFactions::TimeGuest)),"1 - временный гость");
		player.Say((19+(AnswerIdFactions::Guest)),"2 - гость");
		player.Say((19+(AnswerIdFactions::Citizen)),"3 - гражданин");
		player.Say((19+(AnswerIdFactions::RichCitizen)),"4 - богатый гражданин");
		player.Say((19+(AnswerIdFactions::Outcast)),"10 - изгой");
	}
}

void answer_GM_PANNEL_SELF_LOG(Critter&cr,uint answerI,string&answerS)
{
	if(!(@cr!=null))
	return;
	if(answerI==0)
	{
		file f;
		if(f.open("logs\\help_pleads.txt","r")>=0)
		{
			string word="";
			uint pos=0;
			f.setPos(0);
			while(!f.isEndOfFile())
			{
				pos=f.getPos();
				if(pos==0)
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",0,0,0,word,null);
				}
				else
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",1,0,0,word,null);
				}
			}
			f.close();
		}
		else
		Log("can't open!");
	}
	if(answerI==1)
	{
		file f;
		if(f.open("logs\\warnings.txt","r")>=0)
		{
			string word="";
			uint pos=0;
			f.setPos(0);
			while(!f.isEndOfFile())
			{
				pos=f.getPos();
				if(pos==0)
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",0,1,0,word,null);
				}
				else
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",1,1,0,word,null);
				}
			}
			f.close();
		}
		else
		Log("can't open!");
	}
	if(answerI==2)
	{
		file f;
		if(f.open("logs\\killings.txt","r")>=0)
		{
			string word="";
			uint pos=0;
			f.setPos(0);
			while(!f.isEndOfFile())
			{
				pos=f.getPos();
				if(pos==0)
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",0,2,0,word,null);
				}
				else
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",1,2,0,word,null);
				}
			}
			f.close();
		}
		else
		Log("can't open!");
	}
	if(answerI==3)
	{
		file f;
		if(f.open("logs\\factions.txt","r")>=0)
		{
			string word="";
			uint pos=0;
			f.setPos(0);
			while(!f.isEndOfFile())
			{
				pos=f.getPos();
				if(pos==0)
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",0,3,0,word,null);
				}
				else
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",1,3,0,word,null);
				}
			}
			f.close();
		}
		else
		Log("can't open!");
	}
	if(answerI==4)
	{
		file f;
		if(f.open("save\\bans\\qbans.txt","r")>=0)
		{
			string word="";
			uint pos=0;
			f.setPos(0);
			while(!f.isEndOfFile())
			{
				pos=f.getPos();
				if(pos==0)
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",0,4,0,word,null);
				}
				else
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",1,4,0,word,null);
				}
			}
			f.close();
		}
		else
		Log("can't open!");
	}
	if(answerI==5)
	{
		file f;
		if(f.open("save\\bans\\crims.txt","r")>=0)
		{
			string word="";
			uint pos=0;
			f.setPos(0);
			while(!f.isEndOfFile())
			{
				pos=f.getPos();
				if(pos==0)
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",0,8,0,word,null);
				}
				else
				{
					f.readLine(word);
					cr.RunClientScript("client_main@loger",1,8,0,word,null);
				}
			}
			f.close();
		}
		else
		Log("can't open!");
	}
	if(answerI==9&&cr.GetAccess()>(2))
	{
		cr.ShowScreen((2),13,"answer_GM_PANNEL_SELF_LOG_CLEAN");
		cr.Say((18),"Выберете назначаемый режим");
		cr.Say((19+(0)),"0 - очистка help");
		cr.Say((19+(1)),"1 - очистка warn");
		cr.Say((19+(2)),"2 - очистка kill");
		cr.Say((19+(3)),"3 - очистка factions");
	}
	if(answerI==10)
	{
		GM_PANNEL_SELF(cr,0,0,0,null,null);
	}
}

void answer_GM_PANNEL_SELF_LOG_CLEAN(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		file f;
		if(f.open("logs\\help_pleads.txt","w")>=0)
		{
			
			f.close();
		}
		else
		Log("can't open!");
	}
	if(answerI==1)
	{
		file f;
		if(f.open("logs\\warnings.txt","w")>=0)
		{
			
			f.close();
		}
		else
		Log("can't open!");
	}
	if(answerI==2)
	{
		file f;
		if(f.open("logs\\killings.txt","w")>=0)
		{
			
			f.close();
		}
		else
		Log("can't open!");
	}
	if(answerI==3)
	{
		file f;
		if(f.open("logs\\factions.txt","w")>=0)
		{
			
			f.close();
		}
		else
		Log("can't open!");
	}
}

void answer_GM_PANNEL_SELF_MYMODES(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		GM_PANNEL_CRITTER_PLAYER(player,player.Id,0,0,null,null);
	}
	if(answerI==1)
	{
		if(player.ModeBase[(527)]==0)
		player.ModeBase[(527)]=1;
		else
		player.ModeBase[(527)]=0;
	}
	if(answerI==2)
	{
		if(player.Quest[(702)]==0)
		player.QuestBase[(702)]=200;
		else
		player.QuestBase[(702)]=0;
	}
	if(answerI==3)
	{
		if(player.Mode[(514)]==0)
		player.ModeBase[(514)]=1;
		else
		player.ModeBase[(514)]=0;
	}
	if(answerI==4)
	{
		if(player.Stat[(119)]==0)
		{
			player.StatBase[(119)]=1;
			sinf(player,0,119,0);
		}
		else
		{
			player.StatBase[(119)]=0;
			sinf(player,0,0,0);
		}
	}
	if(answerI==5)
	{
		GM_PANNEL_SELF(player,0,0,0,null,null);
	}
}

void answer_GM_PANNEL_SELF_TOWNMODES(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		GameVar@war_mode=GetGlobalVar((7340));
		player.ShowScreen((2),5,"answer_GM_PANNEL_SELF_TOWNMODES_WAR");
		player.Say((18),"воен положение, текущее - "+war_mode.GetValue());
		player.Say((19+(0)),"0 мир");
		player.Say((19+(1)),"1 -чужаки");
		player.Say((19+(2)),"2 #чужаки");
		player.Say((19+(3)),"3 defcon 4");
		player.Say((19+(4)),"4 defcon 5");
	}
	if(answerI==1)
	{
		GameVar@guards_mode=GetGlobalVar((7341));
		player.ShowScreen((2),2,"answer_GM_PANNEL_SELF_TOWNMODES_GUARD");
		player.Say((18),"активность гвардии, текущий - "+guards_mode.GetValue());
		player.Say((19+(0)),"0 мир");
	}
	if(answerI==2)
	{
		GameVar@races_mode=GetGlobalVar((7342));
		player.ShowScreen((2),2,"answer_GM_PANNEL_SELF_TOWNMODES_RACES");
		player.Say((18),"расизм, текущий - "+races_mode.GetValue());
		player.Say((19+(0)),"0 мир");
	}
	if(answerI==3)
	{
		GameVar@border_mode=GetGlobalVar((7343));
		player.ShowScreen((2),5,"answer_GM_PANNEL_SELF_TOWNMODES_GATES");
		player.Say((18),"шлюз, текущий - "+border_mode.GetValue());
		player.Say((19+(0)),"0 обычный");
		player.Say((19+(1)),"1 без гостей");
		player.Say((19+(2)),"2 карантин");
		player.Say((19+(3)),"3 изоляция");
		player.Say((19+(4)),"4 открытый");
	}
	if(answerI==4)
	{
		GameVar@Reg=GetGlobalVar((7344));
		if(Reg.GetValue()==0)
		Reg=(1);
		else
		Reg=(0);
	}
	if(answerI==5)
	{
		GM_PANNEL_SELF(player,0,0,0,null,null);
	}
}

void answer_GM_PANNEL_SELF_TOWNMODES_WAR(Critter&player,uint answerI,string&answerS)
{
	GameVar@war_mode=GetGlobalVar((7340));
	war_mode=(answerI);
	
	player.ShowScreen((2),5,"answer_GM_PANNEL_SELF_TOWNMODES_WAR");
	player.Say((18),"воен положение, текущее - "+war_mode.GetValue());
	player.Say((19+(0)),"0 мир");
	player.Say((19+(1)),"1 -чужаки");
	player.Say((19+(2)),"2 #чужаки");
	player.Say((19+(3)),"3 defcon 4");
	player.Say((19+(4)),"4 defcon 5");
}

void answer_GM_PANNEL_SELF_TOWNMODES_GUARD(Critter&player,uint answerI,string&answerS)
{
	GameVar@guards_mode=GetGlobalVar((7341));
	guards_mode=(answerI);
}

void answer_GM_PANNEL_SELF_TOWNMODES_RACES(Critter&player,uint answerI,string&answerS)
{
	GameVar@races_mode=GetGlobalVar((7342));
	races_mode=(answerI);
}

void answer_GM_PANNEL_SELF_TOWNMODES_GATES(Critter&player,uint answerI,string&answerS)
{
	GameVar@border_mode=GetGlobalVar((7343));
	border_mode=(answerI);
	
	player.ShowScreen((2),5,"answer_GM_PANNEL_SELF_TOWNMODES_GATES");
	player.Say((18),"шлюз, текущий - "+border_mode.GetValue());
	player.Say((19+(0)),"0 обычный");
	player.Say((19+(1)),"1 без гостей");
	player.Say((19+(2)),"2 карантин");
	player.Say((19+(3)),"3 изоляция");
	player.Say((19+(4)),"4 открытый");
}

void GM_PANNEL_CRITTER_PLAYER(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(player.GetAccess()>=(2))
	{
		Critter@cr=GetCritter(param0);
		if(cr is null)
		return;
		player.StatBase[(90)]=cr.Id;
		player.ShowScreen((2),5,"answer_GM_PANNEL_CRITTER_PLAYER");
		player.Say((18),"Действия с игроком"+param0);
		if(cr.Quest[(703)]==(0))
		player.Say((19+(0)),"Mode START");
		else if(cr.Quest[(703)]==(1))
		player.Say((19+(0)),"Mode Adventure");
		else if(cr.Quest[(703)]==(2))
		player.Say((19+(0)),"Mode SURVIVAL");
		else if(cr.Quest[(703)]==(3))
		player.Say((19+(0)),"Mode ARCADE");
		else if(cr.Quest[(703)]==(4))
		player.Say((19+(0)),"Mode TEST");
		else
		player.Say((19+(0)),"ошибка режима");
		player.Say((19+(1)),"Параметры");
		player.Say((19+(2)),"Модерация");
		player.Say((19+(3)),"Инвентарь");
		player.Say((19+(4)),"Поощрения");
	}
}

string[]GM_SetParamNames={"Опыт","Голод","Жажда","Здоровье","Кровь","Передоз","Заражение","Радиация","Отравление"};
int[]GM_SetParams={(76),(128),(127),(72),(149),(148),(147),(74),(73)};

void answer_GM_PANNEL_CRITTER_PLAYER(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	if(answerI==0)
	{
		player.ShowScreen((2),6,"answer_GM_PANNEL_CRITTER_PLAYER_GAMEMODES");
		player.Say((18),"Текущий режим ="+cr.Quest[(703)]+" , выберите новый режим игры");
		player.Say((19+(0)),"0 Mode START");
		player.Say((19+(1)),"1 Mode Adventure");
		player.Say((19+(2)),"2 Mode SURVIVAL");
		player.Say((19+(3)),"3 Mode ARCADE");
		player.Say((19+(4)),"4 Mode TEST");
		player.Say((19+(5)),"назад");
	}
	if(answerI==1)
	{
		player.ShowScreen((2),10,"answer_GM_PANNEL_CRITTER_PLAYER_STATS");
		player.Say((18),"Параметры игрока");
		player.Say((19+(0)),"SPECIAL");
		player.Say((19+(1)),"SKILLS 0-9");
		player.Say((19+(2)),"SKILLS 10-20");
		player.Say((19+(3)),"Травмы");
		player.Say((19+(4)),"Режимы");
		player.Say((19+(5)),"Скин/бодитайп");
		player.Say((19+(6)),"Фр="+cr.Quest[(704)]+",Пр="+cr.Quest[(705)]);
		player.Say((19+(7)),"Доп парам");
		player.Say((19+(8)),"Лексема");
		player.Say((19+(9)),"назад");
	}
	if(answerI==2)
	{
		player.ShowScreen((2),9,"answer_GM_PANNEL_CRITTER_PLAYER_BANS");
		player.Say((18),"Модерация");
		player.Say((19+(0)),"Предупреждение");
		player.Say((19+(1)),"Kick");
		player.Say((19+(2)),"Kill");
		player.Say((19+(3)),"Ban");
		player.Say((19+(4)),"Kick Ban");
		player.Say((19+(5)),"Ban IP");
		player.Say((19+(6)),"unBan");
		player.Say((19+(7)),"Hard_Ban");
		player.Say((19+(8)),"назад");
	}
	if(answerI==3)
	{
		player.ShowContainer(cr,null,(8));
	}
	if(answerI==4)
	{
		player.ShowScreen((2),15,"answer_GM_PANNEL_CRITTER_PLAYER_GIFT");
		player.Say((18),"Модерация");
		player.Say((19+(0)),"назад");
		player.Say((19+(1)),"Карма&Зависимости");
		player.Say((19+(2)),"Перк");
		for(int i=3;i<12;i++)
		player.Say((19+(i)),GM_SetParamNames[i-3]+" ["+cr.StatBase[GM_SetParams[i-3]]+"]");
		player.Say((19+(12)),((((cr.StatBase[(146)])&((0x040)))!=0)?"Выкл.":"Вкл.")+" Пулевое");
		player.Say((19+(13)),((((cr.StatBase[(146)])&((0x010)))!=0)?"Выкл.":"Вкл.")+" Тяж.Рана");
		player.Say((19+(14)),"[обновить]");
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_GIFT_KARMA(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		answer_GM_PANNEL_CRITTER_PLAYER(player,4,"");
		return;
	}
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(answerI==1)
	{
		player.StatBase[(91)]=(80);
		player.StatBase[(92)]=0;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_GIFT_ADD");
		player.Say((39),"Карма: ["+cr.Stat[(80)]+"]");
		return;
	} 
	
	if(answerI==2)
	cr.AddictionBase[(475)]=1-cr.AddictionBase[(475)];
	if(answerI==3)
	cr.AddictionBase[(471)]=1-cr.AddictionBase[(471)];
	if(answerI==4)
	cr.AddictionBase[(472)]=1-cr.AddictionBase[(472)];
	if(answerI==5)
	cr.AddictionBase[(473)]=1-cr.AddictionBase[(473)];
	if(answerI==6)
	cr.AddictionBase[(474)]=1-cr.AddictionBase[(474)];
	if(answerI==7)
	cr.AddictionBase[(470)]=1-cr.AddictionBase[(470)];
	if(answerI==8)
	cr.AddictionBase[(476)]=1-cr.AddictionBase[(476)];
	answer_GM_PANNEL_CRITTER_PLAYER_GIFT(player,1,"");
}

void answer_GM_PANNEL_CRITTER_PLAYER_GIFT(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	
	if(cr is null)
	return;
	
	if(answerI==0){
		GM_PANNEL_CRITTER_PLAYER(player,cr.Id,0,0,null,null);
		return;
	}
	
	if(answerI==1)
	{
		player.ShowScreen((2),10,"answer_GM_PANNEL_CRITTER_PLAYER_GIFT_KARMA");
		player.Say((18),"Карма = "+cr.Stat[(80)]);
		player.Say((19+(0)),"назад");
		player.Say((19+(1)),"Карма");
		player.Say((19+(2)),(cr.AddictionBase[(475)]!=0?"Выкл.":"Вкл.")+" Джет");
		player.Say((19+(3)),(cr.AddictionBase[(471)]!=0?"Выкл.":"Вкл.")+" Буффаут");
		player.Say((19+(4)),(cr.AddictionBase[(472)]!=0?"Выкл.":"Вкл.")+" Ментаты");
		player.Say((19+(5)),(cr.AddictionBase[(473)]!=0?"Выкл.":"Вкл.")+" Психо");
		player.Say((19+(6)),(cr.AddictionBase[(474)]!=0?"Выкл.":"Вкл.")+" Радэвей");
		player.Say((19+(7)),(cr.AddictionBase[(470)]!=0?"Выкл.":"Вкл.")+" Нюка");
		player.Say((19+(8)),(cr.AddictionBase[(476)]!=0?"Выкл.":"Вкл.")+" Азартный");
		return;
	}
	if(answerI==2)
	{
		player.StatBase[(91)]=(__PerkBegin);
		player.StatBase[(92)]=0;
		player.ShowScreen((2),12,"answer_GM_PANNEL_CRITTER_PLAYER_GIFT_PERK");
		player.Say((18),"Выбор перка:");
		player.Say((19+(0)),"назад");
		for(uint i=1;i<11;i++)
		{
			player.SayMsg((19+(i)),(3),(10000+player.Stat[(91)]+i)*10+1);
		}
		player.Say((19+(11)),"далее");
		return;
	}
	if(answerI>=3&&answerI<=11){
		int n=(((answerI-3)>(GM_SetParamNames.length()))?(GM_SetParamNames.length()):(((answerI-3)<(0))?(0):(answerI-3)));
		player.StatBase[(91)]=GM_SetParams[n];
		player.StatBase[(92)]=0;
		player.StatBase[(93)]=1;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_GIFT_ADD");
		player.Say((39),GM_SetParamNames[n]+": ["+cr.ParamBase[GM_SetParams[n]]+"]");
		return;
	}
	if(answerI==12)
	ChangeStatus(cr,(0x040),0,!(((cr.StatBase[(146)])&((0x040)))!=0));
	if(answerI==13)
	ChangeStatus(cr,(0x010),0,!(((cr.StatBase[(146)])&((0x010)))!=0));
	if(answerI==14)
	{
		player.ShowScreen((2),15,"answer_GM_PANNEL_CRITTER_PLAYER_GIFT");
		player.Say((18),"Модерация");
		player.Say((19+(0)),"назад");
		player.Say((19+(1)),"Карма&Зависимости");
		player.Say((19+(2)),"Перк");
		for(int i=3;i<12;i++)
		player.Say((19+(i)),GM_SetParamNames[i-3]+" ["+cr.StatBase[GM_SetParams[i-3]]+"]");
		player.Say((19+(12)),((((cr.StatBase[(146)])&((0x040)))!=0)?"Выкл.":"Вкл.")+" Пулевое");
		player.Say((19+(13)),((((cr.StatBase[(146)])&((0x010)))!=0)?"Выкл.":"Вкл.")+" Тяж.Рана");
		player.Say((19+(14)),"[обновить]");
	}
	answer_GM_PANNEL_CRITTER_PLAYER(player,4,"");
}

void answer_GM_PANNEL_CRITTER_PLAYER_GIFT_PERK(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	
	if(answerI==0&&uint(player.Stat[(91)])>(__PerkBegin)+10)
	player.StatBase[(91)]-=11;
	if(answerI==11&&uint(player.Stat[(91)])<(__PerkEnd)-10)
	player.StatBase[(91)]+=11;
	
	player.ShowScreen((2),12,"answer_GM_PANNEL_CRITTER_PLAYER_GIFT_PERK");
	player.Say((18),"Выбор перка");
	player.Say((19+(0)),"назад");
	for(uint i=1;i<11;i++)
	player.SayMsg((19+(i)),(3),(10000+player.Stat[(91)]+i)*10+1);
	player.Say((19+(11)),"далее");
	
	if(player.Stat[(92)]==0)
	{
		if((answerI==11)||(answerI==0&&uint(player.Stat[(91)])<=(__PerkBegin)+10))return;
		int perkId=player.Stat[(91)]+answerI;
		cr.PerkBase[perkId]++;
		player.Say((11),"вы дали перк "+perkId+" игроку "+cr.Id);
	}
	else
	{
		if((answerI==11)||(answerI==0&&uint(player.Stat[(91)])<=(__PerkBegin)+10))return;
		int perkId=player.Stat[(91)]+answerI;
		cr.PerkBase[perkId]--;
		player.Say((11),"вы отняли перк "+perkId+" у игрока "+cr.Id);
	}
}

import void AffectRadiation(Critter&cr,int value)from"radiation";
import void AffectPoison(Critter&cr,int value)from"poison";

void ask_GM_PANNEL_CRITTER_PLAYER_GIFT_ADD(Critter&player,uint answerI,string&answerS)
{
	Critter@target=GetCritter(player.Stat[(90)]);
	int parameter=player.Stat[(91)];
	if(!(@target!=null))
	return;
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		if(player.Stat[(92)]==0)
		{
			target.ParamBase[parameter]+=number;
			player.Say((11),"вы увеличили параметр "+parameter+" на "+number+" у игрока "+target.Id);
		}
		else
		{
			target.ParamBase[parameter]-=number;
			player.Say((11),"вы уменьшили параметр "+parameter+" на "+number+" у игрока "+target.Id);
		}
		ChangeCritterSpeed(target);
		if(parameter==(74))
		AffectRadiation(target,0);
		if(parameter==(73))
		AffectPoison(target,0);
	}
	if(player.Stat[(93)]==1)answer_GM_PANNEL_CRITTER_PLAYER(player,4,"");
	else GM_PANNEL_CRITTER_PLAYER(player,target.Id,0,0,null,null);
} 

void answer_GM_PANNEL_CRITTER_PLAYER_GAMEMODES(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	cr.QuestBase[(703)]=answerI;
	Log_factions(player,cr.Id,0,answerI,null,null);
}

void answer_GM_PANNEL_CRITTER_PLAYER_BANS(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	if(answerI==0)
	{
		Warn(player,cr.Id,0,0);
	}
	if(answerI==1)
	{
		KickId(player,cr.Id,0,0);
	}
	if(answerI==2)
	{
		player.ShowScreen((2),10,"answer_GM_PANNEL_CRITTER_PLAYER_BANS_KILL");
		player.Say((18),"Убить предельно жестоким способом");
		player.Say((19+(0)),"Просто смерть");
		player.Say((19+(1)),"Вырыв бока");
		player.Say((19+(2)),"Разрыв Очередью");
		player.Say((19+(3)),"очередью");
		player.Say((19+(4)),"в прах");
		player.Say((19+(5)),"в куски");
		player.Say((19+(6)),"огонь");
		player.Say((19+(7)),"в соплю");
		player.Say((19+(8)),"пополам");
		player.Say((19+(9)),"назад");
	}
	if(answerI==3)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_BANS_BAN");
		player.Say((39),"Бан "+GetPlayerName(cr.Id)+" на часов:");
	}
	if(answerI==4)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_BANS_KICKBAN");
		player.Say((39),"Бан "+GetPlayerName(cr.Id)+" на часов:");
	}
	if(answerI==5)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_BANS_KICKBANIP");
		player.Say((39),"Бан по IP"+GetPlayerName(cr.Id)+" на часов:");
	}
	if(answerI==6)
	{
		UnbanId(player,cr.Id,0,0);
		player.Say((11),"персонаж "+GetPlayerName(cr.Id)+"("+cr.Id+")"+" разблокирован");
		
		player.ShowScreen((2),8,"answer_GM_PANNEL_CRITTER_PLAYER_BANS");
		player.Say((18),"Модерация");
		player.Say((19+(0)),"Предупреждение");
		player.Say((19+(1)),"Kick");
		player.Say((19+(2)),"Kill");
		player.Say((19+(3)),"Ban");
		player.Say((19+(4)),"Kick Ban");
		player.Say((19+(5)),"Ban IP");
		player.Say((19+(6)),"unBan");
		player.Say((19+(7)),"назад");
	}
	if(answerI==7)
	{
		GM_HardBanId(player,cr.Id);
		player.Say((11),"персонаж "+GetPlayerName(cr.Id)+"("+cr.Id+")"+" заблокирован по системе");
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_BANS_BAN");
		player.Say((39),"Бан "+GetPlayerName(cr.Id)+" на часов:");
	}
	if(answerI==8)
	{
		GM_PANNEL_CRITTER_PLAYER(player,cr.Id,0,0,null,null);
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_BANS_KILL(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)return;
	
	if(answerI==9)
	{
		GM_PANNEL_CRITTER_PLAYER(player,cr.Id,0,0,null,null);
		return;
	}
	
	killbytype(player,answerI,0,0,null,null);
}

void ask_GM_PANNEL_CRITTER_PLAYER_BANS_UNBAN(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		Critter@cr=GetCritter(player.Stat[(90)]);
		if(cr is null)
		return;
		int number=0;
		StrToInt(answerS,number);
		if(number<=0)
		{
			player.Say((11),"неверное значение");
			return;
		}
		KickBanIdIp(player,cr.Id,number,0);
		player.Say((11),"персонаж "+GetPlayerName(cr.Id)+"("+cr.Id+")"+" заблокирован по IP на "+number+" часов");
		
		player.ShowScreen((2),8,"answer_GM_PANNEL_CRITTER_PLAYER_BANS");
		player.Say((18),"Модерация");
		player.Say((19+(0)),"Предупреждение");
		player.Say((19+(1)),"Kick");
		player.Say((19+(2)),"Kill");
		player.Say((19+(3)),"Ban");
		player.Say((19+(4)),"Kick Ban");
		player.Say((19+(5)),"Ban IP");
		player.Say((19+(6)),"unBan");
		player.Say((19+(7)),"назад");
	}
}

void ask_GM_PANNEL_CRITTER_PLAYER_BANS_KICKBANIP(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		Critter@cr=GetCritter(player.Stat[(90)]);
		if(cr is null)
		return;
		int number=0;
		StrToInt(answerS,number);
		if(number<=0)
		{
			player.Say((11),"неверное значение");
			return;
		}
		KickBanIdIp(player,cr.Id,number,0);
		player.Say((11),"персонаж "+GetPlayerName(cr.Id)+"("+cr.Id+")"+" заблокирован по IP на "+number+" часов");
		
		player.ShowScreen((2),8,"answer_GM_PANNEL_CRITTER_PLAYER_BANS");
		player.Say((18),"Модерация");
		player.Say((19+(0)),"Предупреждение");
		player.Say((19+(1)),"Kick");
		player.Say((19+(2)),"Kill");
		player.Say((19+(3)),"Ban");
		player.Say((19+(4)),"Kick Ban");
		player.Say((19+(5)),"Ban IP");
		player.Say((19+(6)),"unBan");
		player.Say((19+(7)),"назад");
	}
}

void ask_GM_PANNEL_CRITTER_PLAYER_BANS_KICKBAN(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		Critter@cr=GetCritter(player.Stat[(90)]);
		if(cr is null)
		return;
		int number=0;
		StrToInt(answerS,number);
		if(number<=0)
		{
			player.Say((11),"неверное значение");
			return;
		}
		BanId(player,cr.Id,number,1);
		player.Say((11),"персонаж "+GetPlayerName(cr.Id)+"("+cr.Id+")"+" заблокирован на "+number+" часов");
		
		player.ShowScreen((2),8,"answer_GM_PANNEL_CRITTER_PLAYER_BANS");
		player.Say((18),"Модерация");
		player.Say((19+(0)),"Предупреждение");
		player.Say((19+(1)),"Kick");
		player.Say((19+(2)),"Kill");
		player.Say((19+(3)),"Ban");
		player.Say((19+(4)),"Kick Ban");
		player.Say((19+(5)),"Ban IP");
		player.Say((19+(6)),"unBan");
		player.Say((19+(7)),"назад");
	}
}

void ask_GM_PANNEL_CRITTER_PLAYER_BANS_BAN(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		Critter@cr=GetCritter(player.Stat[(90)]);
		if(cr is null)
		return;
		int number=0;
		StrToInt(answerS,number);
		if(number<=0)
		{
			player.Say((11),"неверное значение");
			return;
		}
		BanId(player,cr.Id,number,0);
		player.Say((11),"персонаж "+GetPlayerName(cr.Id)+"("+cr.Id+")"+"заблокирован на "+number+" часов");
		
		player.ShowScreen((2),8,"answer_GM_PANNEL_CRITTER_PLAYER_BANS");
		player.Say((18),"Модерация");
		player.Say((19+(0)),"Предупреждение");
		player.Say((19+(1)),"Kick");
		player.Say((19+(2)),"Kill");
		player.Say((19+(3)),"Ban");
		player.Say((19+(4)),"Kick Ban");
		player.Say((19+(5)),"Ban IP");
		player.Say((19+(6)),"unBan");
		player.Say((19+(7)),"назад");
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	if(answerI==0)
	{
		player.ShowScreen((2),7,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((18),"SPECIAL игрока");
		player.Say((19+(0)),""+cr.StatBase[(0)]+" - сила");
		player.Say((19+(1)),""+cr.StatBase[(1)]+" - восприятие");
		player.Say((19+(2)),""+cr.StatBase[(2)]+" - выносливость");
		player.Say((19+(3)),""+cr.StatBase[(3)]+" - харизма");
		player.Say((19+(4)),""+cr.StatBase[(4)]+" - интеллект");
		player.Say((19+(5)),""+cr.StatBase[(5)]+" - ловкость");
		player.Say((19+(6)),""+cr.StatBase[(6)]+" - удача");
	}
	if(answerI==1)
	{
		player.ShowScreen((2),11,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKILL1");
		player.Say((18),"Навыки игрока");
		player.Say((19+(0)),""+cr.SkillBase[(200)]+" - легкое");
		player.Say((19+(1)),""+cr.SkillBase[(201)]+" - тяжолое");
		player.Say((19+(2)),""+cr.SkillBase[(202)]+" - энерго");
		player.Say((19+(3)),""+cr.SkillBase[(203)]+" - рукопашная");
		player.Say((19+(4)),""+cr.SkillBase[(204)]+" - холодное");
		player.Say((19+(5)),""+cr.SkillBase[(205)]+" - метание");
		player.Say((19+(6)),""+cr.SkillBase[(206)]+" - санитар");
		player.Say((19+(7)),""+cr.SkillBase[(207)]+" - доктор");
		player.Say((19+(8)),""+cr.SkillBase[(208)]+" - скрытность");
		player.Say((19+(9)),""+cr.SkillBase[(209)]+" - взлом");
		player.Say((19+(10)),""+cr.SkillBase[(210)]+" - кража");
	}
	if(answerI==2)
	{
		player.ShowScreen((2),7,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKILL2");
		player.Say((18),"Навыки игрока");
		player.Say((19+(0)),""+cr.SkillBase[(211)]+" - ловушки");
		player.Say((19+(1)),""+cr.SkillBase[(212)]+" - наука");
		player.Say((19+(2)),""+cr.SkillBase[(213)]+" - ремонт");
		player.Say((19+(3)),""+cr.SkillBase[(214)]+" - разговор");
		player.Say((19+(4)),""+cr.SkillBase[(215)]+" - торговля");
		player.Say((19+(5)),""+cr.SkillBase[(216)]+" - игра");
		player.Say((19+(6)),""+cr.SkillBase[(217)]+" - скиталец");
	}
	if(answerI==3)
	{
		player.ShowScreen((2),7,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_DAMAGES");
		player.Say((18),"Травмы игрока");
		player.Say((19+(0)),""+cr.Damage[(502)]+" - травма глаза");
		player.Say((19+(1)),""+cr.Damage[(503)]+" - правая рука");
		player.Say((19+(2)),""+cr.Damage[(504)]+" - левая рука");
		player.Say((19+(3)),""+cr.Damage[(505)]+" - правая нога");
		player.Say((19+(4)),""+cr.Damage[(506)]+" - левая нога");
		player.Say((19+(5)),""+cr.Damage[(501)]+" - радиация");
		player.Say((19+(6)),""+cr.Damage[(500)]+" - отравление");
	}
	if(answerI==4)
	{
		player.ShowScreen((2),12,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_MODES");
		player.Say((18),"Режимы игрока");
		player.Say((19+(0)),""+cr.Mode[(514)]+" - нопвп");
		player.Say((19+(1)),""+cr.Mode[(527)]+" - неуязвимость");
		player.Say((19+(2)),""+cr.Mode[(532)]+" - нелутаемость");
		player.Say((19+(3)),""+cr.Mode[(511)]+" - неворуемость");
		player.Say((19+(4)),""+cr.Mode[(536)]+" - непихаемость");
		player.Say((19+(5)),""+cr.Mode[(539)]+" - стоять");
		player.Say((19+(6)),""+cr.Mode[(540)]+" - нет бега");
		player.Say((19+(7)),""+cr.Mode[(524)]+" - нет травм");
		player.Say((19+(8)),""+cr.Mode[(531)]+" - несбиваемость");
		player.Say((19+(9)),""+cr.Quest[(700)]+" - пси-способности");
		player.Say((19+(10)),""+cr.Mode[(522)]+" - беск. патроны");
		player.Say((19+(11)),"[обновить]");
	}
	if(answerI==5)
	{
		player.ShowScreen((2),7,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS");
		player.Say((18),"Текущий скин - "+cr.Stat[(112)]);
		player.Say((19+(0)),""+cr.Stat[(67)]+" - бодитайп");
		player.Say((19+(1)),""+cr.Stat[(112)]+" - скин вручную");
		player.Say((19+(2)),"стандартный");
		player.Say((19+(3)),"дикари");
		player.Say((19+(4)),"гражданские");
		player.Say((19+(5)),"бандитские");
		player.Say((19+(6)),"разное");
	}
	if(answerI==6)
	{
		player.ShowScreen((2),AnswerIdFactions::CountAnswer,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_FACTIONS");
		player.Say((18),"Текущая фракция - "+cr.Quest[(704)]+". Текущий пропуск - "+cr.Quest[(705)]); 
		
		player.Say((19+(AnswerIdFactions::NoFaction)),"0 - без фракции");
		player.Say((19+(AnswerIdFactions::Administration)),"1 - администрация");
		player.Say((19+(AnswerIdFactions::Cop)),"2 - полиция");
		player.Say((19+(AnswerIdFactions::Mafia)),"3 - мафия");
		player.Say((19+(AnswerIdFactions::Mutant)),"4 - мутанты");
		player.Say((19+(AnswerIdFactions::Fort)),"5 - форт");
		player.Say((19+(AnswerIdFactions::Raider)),"6 - рейдеры");
		player.Say((19+(AnswerIdFactions::Sheriff)),"7 - Шериф");
		player.Say((19+(AnswerIdFactions::Mayor)),"8 - Мэр");
		player.Say((19+(AnswerIdFactions::Strange)),"0 - чужак");
		player.Say((19+(AnswerIdFactions::TimeGuest)),"1 - временный гость");
		player.Say((19+(AnswerIdFactions::Guest)),"2 - гость");
		player.Say((19+(AnswerIdFactions::Citizen)),"3 - гражданин");
		player.Say((19+(AnswerIdFactions::RichCitizen)),"4 - богатый гражданин");
		player.Say((19+(AnswerIdFactions::Outcast)),"10 - изгой");              
		
	}
	if(answerI==7)
	{
		player.ShowScreen((2),4,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_PARAM");
		player.Say((18),"Дополнительные параметры");
		player.Say((19+(0)),""+cr.Stat[(72)]+"Текущее хп");
		player.Say((19+(1)),""+cr.Stat[(7)]+"макс хп");
		player.Say((19+(2)),""+cr.Stat[(70)]+"возраст");
		player.Say((19+(3)),""+cr.Stat[(71)]+"пол");
	}
	if(answerI==8)
	{
		ShowInputBoxScreen(player,"gm@unsafe_Description#Описание, приметы",0,(0x00000001));
	}
	if(answerI==9)
	{
		GM_PANNEL_CRITTER_PLAYER(player,cr.Id,0,0,null,null);
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_PARAM(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	
	player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
	
	if(answerI==0)
	{
		player.ToLife();
		player.StatBase[(91)]=(72);
		player.Say((39),"Хп");
	}
	if(answerI==1)
	{
		player.StatBase[(91)]=(7);
		player.Say((39),"Макс Хп");
	}
	if(answerI==2)
	{
		player.StatBase[(91)]=(70);
		player.Say((39),"Возраст");
	}
	if(answerI==3)
	{
		player.StatBase[(91)]=(71);
		player.Say((39),"Пол");
	}
}

void unsafe_Description(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(@param3!is null&&param3.length()!=0)
	{
		Critter@cr=GetCritter(player.Stat[(90)]);
		if(@cr is null)
		return;
		cr.SetLexems(param3);
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_DAMAGES(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	if(answerI==0)
	{
		if(cr.Damage[(502)]==0)
		cr.DamageBase[(502)]=1;
		else
		cr.DamageBase[(502)]=0;
	}
	else if(answerI==1)
	{
		if(cr.Damage[(503)]==0)
		cr.DamageBase[(503)]=1;
		else
		cr.DamageBase[(503)]=0;
	}
	else if(answerI==2)
	{
		if(cr.Damage[(504)]==0)
		cr.DamageBase[(504)]=1;
		else
		cr.DamageBase[(504)]=0;
	}
	else if(answerI==3)
	{
		if(cr.Damage[(505)]==0)
		cr.DamageBase[(505)]=1;
		else
		cr.DamageBase[(505)]=0;
	}
	else if(answerI==4)
	{
		if(cr.Damage[(506)]==0)
		cr.DamageBase[(506)]=1;
		else
		cr.DamageBase[(506)]=0;
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	if(answerI==0)
	{
		player.ShowScreen((2),15,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS_BODY");
		player.Say((18),"Текущий бодитайп - "+cr.Stat[(67)]);
		player.Say((19+(0)),"1 мужчина");
		player.Say((19+(1)),"2 женщина");
		player.Say((19+(2)),"3 ребенок");
		player.Say((19+(3)),"4 супермутант");
		player.Say((19+(4)),"5 гуль");
		player.Say((19+(5)),"6 брамин");
		player.Say((19+(6)),"7 радскорпион");
		player.Say((19+(7)),"8 крыса");
		player.Say((19+(8)),"9 летун");
		player.Say((19+(9)),"10 кентавр");
		player.Say((19+(10)),"11 робот");
		player.Say((19+(11)),"12 пес");
		player.Say((19+(12)),"13 мантис");
		player.Say((19+(13)),"14 коготь смерти");
		player.Say((19+(14)),"15 растение");
	}
	if(answerI==1)
	{
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS");
		player.Say((39),"Номер скина");
	}
	if(answerI==2)
	{
		cr.ChangeCrType(cr.Stat[(71)]==(0)?((62)):((61)));
		cr.StatBase[(112)]=cr.Stat[(71)]==(0)?((62)):((61));
	}
	if(answerI==3)
	{
		player.ShowScreen((2),6,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS_BODY");
		player.Say((18),"Текущий скин - "+cr.Stat[(112)]);
		player.Say((19+(0)),"62 Дикарь");
		player.Say((19+(1)),"64 сулик");
		player.Say((19+(2)),"110 патлатый");
		player.Say((19+(3)),"120 лысый");
		player.Say((19+(4)),"61 Дикарка");
		player.Say((19+(5)),"63 Дикарка хв.");
	}
	if(answerI==4)
	{
		player.ShowScreen((2),15,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS_CIVIL");
		player.Say((18),"Текущий скин - "+cr.Stat[(112)]);
		player.Say((19+(0)),"33 Блондинка");
		player.Say((19+(1)),"36 Девушка");
		player.Say((19+(2)),"37 Шлюха");
		player.Say((19+(3)),"39 Негр в кр.");
		player.Say((19+(4)),"40 свитер");
		player.Say((19+(5)),"41 рубашка");
		player.Say((19+(6)),"42 Коротышка");
		player.Say((19+(7)),"43 Бомж сгорбленный");
		player.Say((19+(8)),"48 Караванщик");
		player.Say((19+(9)),"72 костюм");
		player.Say((19+(10)),"73 Китти");
		player.Say((19+(11)),"77 Вышибала");
		player.Say((19+(12)),"57 Доктор");
		player.Say((19+(13)),"89 Ученый");
		player.Say((19+(14)),"91 Вик");
	}
	if(answerI==5)
	{
		player.ShowScreen((2),9,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS_BATTLE");
		player.Say((18),"Текущий скин - "+cr.Stat[(112)]);
		player.Say((19+(0)),"9 Негр");
		player.Say((19+(1)),"34 Бандитка панк");
		player.Say((19+(2)),"35 Мет. жен");
		player.Say((19+(3)),"45 Бандит");
		player.Say((19+(4)),"82 Китаец бед");
		player.Say((19+(5)),"92 Китаец кр.");
		player.Say((19+(6)),"93 Китаец син.");
		player.Say((19+(7)),"94 Китайка");
		player.Say((19+(8)),"87 Полицейский");
	}
	if(answerI==6)
	{
		player.ShowScreen((2),3,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS_MISC");
		player.Say((18),"Текущий скин - "+cr.Stat[(112)]);
		player.Say((19+(0)),"16 собака");
		player.Say((19+(1)),"66 робот боевой");
		player.Say((19+(2)),"65 растение");
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS_CIVIL(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	if(answerI==0)
	{
		cr.ChangeCrType(33);
		cr.StatBase[(112)]=33;
	}
	if(answerI==1)
	{
		cr.ChangeCrType(36);
		cr.StatBase[(112)]=36;
	}
	if(answerI==2)
	{
		cr.ChangeCrType(37);
		cr.StatBase[(112)]=37;
	}
	if(answerI==3)
	{
		cr.ChangeCrType(39);
		cr.StatBase[(112)]=39;
	}
	if(answerI==4)
	{
		cr.ChangeCrType(40);
		cr.StatBase[(112)]=40;
	}
	if(answerI==5)
	{
		cr.ChangeCrType(41);
		cr.StatBase[(112)]=41;
	}
	if(answerI==6)
	{
		cr.ChangeCrType(42);
		cr.StatBase[(112)]=42;
	}
	if(answerI==7)
	{
		cr.ChangeCrType(43);
		cr.StatBase[(112)]=43;
	}
	if(answerI==8)
	{
		cr.ChangeCrType(48);
		cr.StatBase[(112)]=48;
	}
	if(answerI==9)
	{
		cr.ChangeCrType(72);
		cr.StatBase[(112)]=72;
	}
	if(answerI==10)
	{
		cr.ChangeCrType(73);
		cr.StatBase[(112)]=73;
	}
	if(answerI==11)
	{
		cr.ChangeCrType(77);
		cr.StatBase[(112)]=77;
	}
	if(answerI==12)
	{
		cr.ChangeCrType(57);
		cr.StatBase[(112)]=57;
	}
	if(answerI==13)
	{
		cr.ChangeCrType(89);
		cr.StatBase[(112)]=89;
	}
	if(answerI==14)
	{
		cr.ChangeCrType(91);
		cr.StatBase[(112)]=91;
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS_BATTLE(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	if(answerI==0)
	{
		cr.ChangeCrType(9);
		cr.StatBase[(112)]=9;
	}
	if(answerI==1)
	{
		cr.ChangeCrType(34);
		cr.StatBase[(112)]=34;
	}
	if(answerI==2)
	{
		cr.ChangeCrType(35);
		cr.StatBase[(112)]=35;
	}
	if(answerI==3)
	{
		cr.ChangeCrType(45);
		cr.StatBase[(112)]=45;
	}
	if(answerI==4)
	{
		cr.ChangeCrType(82);
		cr.StatBase[(112)]=82;
	}
	if(answerI==5)
	{
		cr.ChangeCrType(92);
		cr.StatBase[(112)]=92;
	}
	if(answerI==6)
	{
		cr.ChangeCrType(93);
		cr.StatBase[(112)]=93;
	}
	if(answerI==7)
	{
		cr.ChangeCrType(94);
		cr.StatBase[(112)]=94;
	}
	if(answerI==8)
	{
		cr.ChangeCrType(87);
		cr.StatBase[(112)]=87;
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS_MISC(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	if(answerI==0)
	{
		cr.ChangeCrType(16);
		cr.StatBase[(112)]=16;
	}
	if(answerI==1)
	{
		cr.ChangeCrType(66);
		cr.StatBase[(112)]=66;
	}
	if(answerI==2)
	{
		cr.ChangeCrType(66);
		cr.StatBase[(112)]=66;
	}
}

void ask_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		Critter@cr=GetCritter(player.Stat[(90)]);
		if(!(@cr!=null))
		{
			player.Say((11),"персонажа "+GetPlayerName(player.Stat[(90)])+"  "+player.Stat[(90)]+" нет онлайн ");
			return;
		}
		cr.ChangeCrType(number);
		cr.StatBase[(112)]=number;
		player.Say((11),"Скин персонажа "+GetPlayerName(player.Stat[(90)])+"  "+player.Stat[(90)]+" был изменен на "+number);
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKINS_BODY(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	cr.StatBase[(67)]=answerI;
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_MODES(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	if(answerI==0)
	{
		if(cr.Mode[(514)]==0)
		cr.ModeBase[(514)]=1;
		else
		cr.ModeBase[(514)]=0;
	}
	if(answerI==1)
	{
		if(cr.Mode[(527)]==0)
		cr.ModeBase[(527)]=1;
		else
		cr.ModeBase[(527)]=0;
	}
	if(answerI==2)
	{
		if(cr.Mode[(532)]==0)
		cr.ModeBase[(532)]=1;
		else
		cr.ModeBase[(532)]=0;
	}
	if(answerI==3)
	{
		if(cr.Mode[(511)]==0)
		cr.ModeBase[(511)]=1;
		else
		cr.ModeBase[(511)]=0;
	}
	if(answerI==4)
	{
		if(cr.Mode[(536)]==0)
		cr.ModeBase[(536)]=1;
		else
		cr.ModeBase[(536)]=0;
	}
	if(answerI==5)
	{
		if(cr.Mode[(539)]==0)
		cr.ModeBase[(539)]=1;
		else
		cr.ModeBase[(539)]=0;
	}
	if(answerI==6)
	{
		if(cr.Mode[(540)]==0)
		cr.ModeBase[(540)]=1;
		else
		cr.ModeBase[(540)]=0;
	}
	if(answerI==7)
	{
		if(cr.Mode[(524)]==0)
		cr.ModeBase[(524)]=1;
		else
		cr.ModeBase[(524)]=0;
	}
	if(answerI==8)
	{
		if(cr.Mode[(531)]==0)
		cr.ModeBase[(531)]=1;
		else
		cr.ModeBase[(531)]=0;
	}
	if(answerI==9)
	{
		player.ShowScreen((2),5,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_MODES_MEDIUM");
		player.Say((18),"Текущий - "+cr.Quest[(700)]);
		player.Say((19+(0)),"0 - нет");
		player.Say((19+(1)),"1 - мастер зверей");
		player.Say((19+(2)),"2 - безликий");
		player.Say((19+(3)),"3 - голос");
		player.Say((19+(4)),"4 - притворщик");
	}
	if(answerI==10)
	{
		cr.ModeBase[(522)]=1-cr.ModeBase[(522)];
	}
	if(answerI==11)
	{
		player.ShowScreen((2),12,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_MODES");
		player.Say((18),"Режимы игрока");
		player.Say((19+(0)),""+cr.Mode[(514)]+" - нопвп");
		player.Say((19+(1)),""+cr.Mode[(527)]+" - неуязвимость");
		player.Say((19+(2)),""+cr.Mode[(532)]+" - нелутаемость");
		player.Say((19+(3)),""+cr.Mode[(511)]+" - неворуемость");
		player.Say((19+(4)),""+cr.Mode[(536)]+" - непихаемость");
		player.Say((19+(5)),""+cr.Mode[(539)]+" - стоять");
		player.Say((19+(6)),""+cr.Mode[(540)]+" - нет бега");
		player.Say((19+(7)),""+cr.Mode[(524)]+" - нет травм");
		player.Say((19+(8)),""+cr.Mode[(531)]+" - несбиваемость");
		player.Say((19+(9)),""+cr.Quest[(700)]+" - пси-способности");
		player.Say((19+(10)),""+cr.Mode[(522)]+" - беск. патроны");
		player.Say((19+(11)),"[обновить]");
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_MODES_MEDIUM(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	if(answerI==4)
	{
		player.StatBase[(91)]=(700);
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"Ид");
	}
	else cr.QuestBase[(700)]=answerI;
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_FACTIONS(Critter&player,uint arg_answerI,string&answerS)
{
	int answerI=arg_answerI;
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	if(answerI==AnswerIdFactions::NoFaction)
	{
		cr.QuestBase[(704)]=AnswerIdFactions::NoFaction;
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,2,AnswerIdFactions::NoFaction,null,null);
	}
	if(answerI==AnswerIdFactions::Administration)
	{
		cr.QuestBase[(704)]=AnswerIdFactions::Administration;
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,2,AnswerIdFactions::Administration,null,null);
	}
	if(answerI==AnswerIdFactions::Cop)
	{
		cr.QuestBase[(704)]=AnswerIdFactions::Cop;
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,2,AnswerIdFactions::Cop,null,null);
	}
	if(answerI==AnswerIdFactions::Mafia)
	{
		cr.QuestBase[(704)]=AnswerIdFactions::Mafia;
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,2,AnswerIdFactions::Mafia,null,null);
	}
	if(answerI==AnswerIdFactions::Mutant)
	{
		cr.QuestBase[(704)]=AnswerIdFactions::Mutant;
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,2,AnswerIdFactions::Mutant,null,null);
	}
	if(answerI==AnswerIdFactions::Fort)
	{
		cr.QuestBase[(704)]=AnswerIdFactions::Fort;
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,2,AnswerIdFactions::Fort,null,null);
	}
	if(answerI==AnswerIdFactions::Raider)
	{
		cr.QuestBase[(704)]=(AnswerIdFactions::Raider);
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,2,AnswerIdFactions::Raider,null,null);
	}
	if(answerI==AnswerIdFactions::Sheriff)
	{
		cr.QuestBase[(704)]=(AnswerIdFactions::Sheriff);
		cr.AddItem(1455,1);
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,2,AnswerIdFactions::Sheriff,null,null);
	}
	if(answerI==AnswerIdFactions::Mayor)
	{
		cr.QuestBase[(704)]=(AnswerIdFactions::Mayor);
		cr.AddItem(913,1);
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,2,AnswerIdFactions::Mayor,null,null);
	}
	if(answerI==AnswerIdFactions::Strange)
	{
		cr.QuestBase[(705)]=(0);
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,1,0,null,null);
	}
	if(answerI==AnswerIdFactions::TimeGuest)
	{
		cr.QuestBase[(705)]=(1);
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,1,1,null,null);
	}
	if(answerI==AnswerIdFactions::Guest)
	{
		cr.QuestBase[(705)]=(2);
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,1,2,null,null);
	}
	if(answerI==AnswerIdFactions::Outcast)
	{
		cr.QuestBase[(705)]=(10);
		RestartFactions(cr,0,0,0);
		cr.MercBase[(800)]=player.Id;
		Log_factions(player,cr.Id,1,10,null,null);
	}
	if(answerI==AnswerIdFactions::Citizen)
	{
		cr.QuestBase[(705)]=(3);
		Item@pass=cr.AddItem((910),1);
		pass.Val1=cr.Id;
		cr.MercBase[(800)]=player.Id;
		player.ShowScreen((5),0,"handcuffs@PassportLex");
		player.Say((39),"Имя в документы");
		player.StatBase[(93)]=pass.Id;
		RestartFactions(cr,0,0,0);
		Log_factions(player,cr.Id,1,3,null,null);
	}
	if(answerI==AnswerIdFactions::RichCitizen)
	{
		cr.QuestBase[(705)]=(4);
		Item@pass=cr.AddItem((910),1);
		pass.Val1=cr.Id;
		cr.MercBase[(800)]=player.Id;
		player.ShowScreen((5),0,"handcuffs@PassportLex");
		player.Say((39),"Имя в документы");
		player.StatBase[(93)]=pass.Id;
		RestartFactions(cr,0,0,0);
		Log_factions(player,cr.Id,1,4,null,null);
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKILL2(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	if(answerI==0)
	{
		player.StatBase[(91)]=211;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"Ловушки");
	}
	if(answerI==1)
	{
		player.StatBase[(91)]=212;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"Наука");
	}
	if(answerI==2)
	{
		player.StatBase[(91)]=213;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"Ремонт");
	}
	if(answerI==3)
	{
		player.StatBase[(91)]=214;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"Разговор");
	}
	if(answerI==4)
	{
		player.StatBase[(91)]=215;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"Торговля");
	}
	if(answerI==5)
	{
		player.StatBase[(91)]=216;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"Азартные игры");
	}
	if(answerI==6)
	{
		player.StatBase[(91)]=217;
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"Скиталец");
	}
} 

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKILL1(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	
	player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
	if(answerI==0)
	{
		player.StatBase[(91)]=200;
		player.Say((39),"Легкое");
	}
	if(answerI==1)
	{
		player.StatBase[(91)]=201;
		player.Say((39),"Тяжелое");
	}
	if(answerI==2)
	{
		player.StatBase[(91)]=202;
		player.Say((39),"Энерго");
	}
	if(answerI==3)
	{
		player.StatBase[(91)]=203;
		player.Say((39),"Рукопашная");
	}
	if(answerI==4)
	{
		player.StatBase[(91)]=204;
		player.Say((39),"Холодное");
	}
	if(answerI==5)
	{
		player.StatBase[(91)]=205;
		player.Say((39),"Метание");
	}
	if(answerI==6)
	{
		player.StatBase[(91)]=206;
		player.Say((39),"Санитар");
	}
	if(answerI==7)
	{
		player.StatBase[(91)]=207;
		player.Say((39),"Доктор");
	}
	if(answerI==8)
	{
		player.StatBase[(91)]=208;
		player.Say((39),"Скрытность");
	}
	if(answerI==9)
	{
		player.StatBase[(91)]=209;
		player.Say((39),"Взлом");
	}
	if(answerI==10)
	{
		player.StatBase[(91)]=210;
		player.Say((39),"Воровство");
	}
}

void answer_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr is null)
	return;
	
	player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
	
	if(answerI==0)
	{
		player.StatBase[(91)]=0;
		player.Say((39),"Сила");
	}
	if(answerI==1)
	{
		player.StatBase[(91)]=1;
		player.Say((39),"Восприятие");
	}
	if(answerI==2)
	{
		player.StatBase[(91)]=2;
		player.Say((39),"Выносливость");
	}
	if(answerI==3)
	{
		player.StatBase[(91)]=3;
		player.Say((39),"Харизма");
	}
	if(answerI==4)
	{
		player.StatBase[(91)]=4;
		player.Say((39),"Интеллект");
	}
	if(answerI==5)
	{
		player.StatBase[(91)]=5;
		player.Say((39),"Ловкость");
	}
	if(answerI==6)
	{
		player.StatBase[(91)]=6;
		player.Say((39),"Удача");
	}
}

void ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL(Critter&player,uint answerI,string&answerS)
{
	Critter@target=GetCritter(player.Stat[(90)]);
	int parameter=player.Stat[(91)];
	if(!(@target!=null))
	return;
	if(answerS.length()>0)
	{
		int number=0;
		StrToInt(answerS,number);
		target.ParamBase[parameter]=number;
		player.Say((11),"вы изменили параметр "+parameter+" на "+number+" у игрока "+target.Id);
		ChangeCritterSpeed(target);
		if(parameter>=0&&parameter<=6)
		{
			player.ShowScreen((2),7,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
			player.Say((18),"SPECIAL игрока");
			player.Say((19+(0)),""+target.StatBase[(0)]+" - сила");
			player.Say((19+(1)),""+target.StatBase[(1)]+" - восприятие");
			player.Say((19+(2)),""+target.StatBase[(2)]+" - выносливость");
			player.Say((19+(3)),""+target.StatBase[(3)]+" - харизма");
			player.Say((19+(4)),""+target.StatBase[(4)]+" - интеллект");
			player.Say((19+(5)),""+target.StatBase[(5)]+" - ловкость");
			player.Say((19+(6)),""+target.StatBase[(6)]+" - удача");
		}
		if(parameter>=200&&parameter<=210)
		{
			player.ShowScreen((2),11,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKILL1");
			player.Say((18),"Навыки игрока");
			player.Say((19+(0)),""+target.SkillBase[(200)]+" - легкое");
			player.Say((19+(1)),""+target.SkillBase[(201)]+" - тяжолое");
			player.Say((19+(2)),""+target.SkillBase[(202)]+" - энерго");
			player.Say((19+(3)),""+target.SkillBase[(203)]+" - рукопашная");
			player.Say((19+(4)),""+target.SkillBase[(204)]+" - холодное");
			player.Say((19+(5)),""+target.SkillBase[(205)]+" - метание");
			player.Say((19+(6)),""+target.SkillBase[(206)]+" - санитар");
			player.Say((19+(7)),""+target.SkillBase[(207)]+" - доктор");
			player.Say((19+(8)),""+target.SkillBase[(208)]+" - скрытность");
			player.Say((19+(9)),""+target.SkillBase[(209)]+" - взлом");
			player.Say((19+(10)),""+target.SkillBase[(210)]+" - кража");
		}
		if(parameter>=211&&parameter<=217)
		{
			player.ShowScreen((2),7,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_SKILL2");
			player.Say((18),"Навыки игрока");
			player.Say((19+(0)),""+target.SkillBase[(211)]+" - ловушки");
			player.Say((19+(1)),""+target.SkillBase[(212)]+" - наука");
			player.Say((19+(2)),""+target.SkillBase[(213)]+" - ремонт");
			player.Say((19+(3)),""+target.SkillBase[(214)]+" - разговор");
			player.Say((19+(4)),""+target.SkillBase[(215)]+" - торговля");
			player.Say((19+(5)),""+target.SkillBase[(216)]+" - игра");
			player.Say((19+(6)),""+target.SkillBase[(217)]+" - скиталец");
		}
		if(parameter==(72)||parameter==(7)||parameter==(70)||parameter==(71))
		{
			player.ShowScreen((2),4,"answer_GM_PANNEL_CRITTER_PLAYER_STATS_PARAM");
			player.Say((18),"Дополнительные параметры");
			player.Say((19+(0)),""+target.StatBase[(72)]+"Текущее хп");
			player.Say((19+(1)),""+target.StatBase[(7)]+"макс хп");
			player.Say((19+(2)),""+target.StatBase[(70)]+"возраст");
			player.Say((19+(3)),""+target.StatBase[(71)]+"пол");
		}
	}
}

void GM_PANNEL_CRITTER_NPC(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	Critter@cr=GetCritter(param0);
	if(@cr is null)return;
	
	if(player.GetAccess()>=(2))
	{
		player.StatBase[(90)]=param0;
		player.ShowScreen((2),5,"answer_GM_PANNEL_CRITTER_NPC");
		player.Say((18),"НПЦ, protoId - "+cr.GetProtoId()+", диалог - "+cr.Stat[(104)]+", Ai - "+GetScriptName(cr.GetScriptId()));
		player.Say((19+(0)),"Ai");
		player.Say((19+(1)),"Режимы");
		player.Say((19+(2)),"Параметры");
		player.Say((19+(3)),"НПЦ-Параметры");
		player.Say((19+(4)),"Инвентарь");
	}
}

void answer_GM_PANNEL_CRITTER_NPC(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.StatBase[(90)]);
	if(cr is null)
	return;
	if(answerI==0)
	{
		player.ShowScreen((5),0,"answer_GM_PANNEL_CRITTER_NPC_AI");
	}
	else if(answerI==1)
	{
		player.ShowScreen((2),14,"answer_GM_PANNEL_CRITTER_NPC_MODES");
		player.Say((18),"Режимы игрока");
		player.Say((19+(0)),""+cr.Mode[(517)]+" - нет дом гекса");
		player.Say((19+(1)),""+cr.Mode[(513)]+" - не запоминает врагов");
		player.Say((19+(2)),""+cr.Mode[(532)]+" - нелутаемость");
		player.Say((19+(3)),""+cr.Mode[(511)]+" - неворуемость");
		player.Say((19+(4)),""+cr.Mode[(536)]+" - непихаемость");
		player.Say((19+(5)),""+cr.Mode[(539)]+" - стоять");
		player.Say((19+(6)),""+cr.Mode[(540)]+" - нет бега");
		player.Say((19+(7)),""+cr.Mode[(524)]+" - нет травм");
		player.Say((19+(8)),""+cr.Mode[(531)]+" - несбиваемость");
		player.Say((19+(9)),""+cr.Mode[(512)]+" - неторгует");
		player.Say((19+(10)),""+cr.Mode[(535)]+" - только наличные");
		player.Say((19+(11)),""+cr.Mode[(541)]+" - не разговаривает");
		player.Say((19+(12)),""+cr.Mode[(522)]+" - беск патроны");
		player.Say((19+(13)),""+cr.Mode[(527)]+" - неуязвимость");
	}
	else if(answerI==2)
	{
		player.ShowScreen((2),9,"answer_GM_PANNEL_CRITTER_PLAYER_STATS");
		player.Say((18),"Параметры, protoId - "+cr.GetProtoId()+", диалог - "+cr.Stat[(104)]);
		player.Say((19+(0)),"SPECIAL");
		player.Say((19+(1)),"SKILLS 0-9");
		player.Say((19+(2)),"SKILLS 10-20");
		player.Say((19+(3)),"Травмы");
		player.Say((19+(4)),"Режимы");
		player.Say((19+(5)),"Скин/бодитайп");
		player.Say((19+(6)),"Фр="+cr.Quest[(704)]+",Пр="+cr.Quest[(705)]);
		player.Say((19+(7)),"Доп парам");
		player.Say((19+(8)),"Лексема");
	}
	else if(answerI==3)
	{
		player.ShowScreen((2),5,"answer_GM_PANNEL_CRITTER_NPC_STATS");
		player.Say((18),"НПЦ параметры, protoId - "+cr.GetProtoId()+", диалог - "+cr.Stat[(104)]);
		player.Say((19+(0)),""+cr.Stat[(104)]+"Диалог");
		player.Say((19+(1)),""+cr.Stat[(105)]+"AI ID");
		player.Say((19+(2)),""+cr.Stat[(89)]+"NPC ROLE");
		player.Say((19+(3)),""+cr.Merc[(800)]+"Master");
		player.Say((19+(4)),""+cr.Stat[(106)]+" Team ID");
	}
	else if(answerI==4)
	{
		player.ShowContainer(cr,null,(8));
	}
}

void answer_GM_PANNEL_CRITTER_NPC_AI(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(@cr!is null)
	{
		string@[]args=splitEx(answerS,"@");
		if(args.length()==1)
		cr.SetScript("Ai@"+answerS);
		else cr.SetScript(answerS);
	}
}

void answer_GM_PANNEL_CRITTER_NPC_STATS(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	if(answerI==0)
	{
		player.ToLife();
		player.StatBase[(91)]=(104);
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"DIALOG_ID");
	}
	if(answerI==1)
	{
		player.StatBase[(91)]=(105);
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"AI_ID");
	}
	if(answerI==2)
	{
		player.StatBase[(91)]=(89);
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"NPC_ROLE");
	}
	if(answerI==3)
	{
		player.StatBase[(91)]=(800);
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"MERC_MASTER_ID");
	}
	if(answerI==4)
	{
		player.StatBase[(91)]=(106);
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"TEAM_ID");
	}
	if(answerI==5)
	{
		GM_PANNEL_CRITTER_NPC(player,cr.Id,0,0,null,null);
	}
}

void answer_GM_PANNEL_CRITTER_NPC_MODES(Critter&player,uint answerI,string&answerS)
{
	Critter@cr=GetCritter(player.Stat[(90)]);
	if(cr is null)
	return;
	if(answerI==0)
	{
		if(cr.Mode[(517)]==0)
		cr.ModeBase[(517)]=1;
		else
		cr.ModeBase[(517)]=0;
	}
	if(answerI==1)
	{
		if(cr.Mode[(513)]==0)
		cr.ModeBase[(513)]=1;
		else
		cr.ModeBase[(513)]=0;
	}
	if(answerI==2)
	{
		if(cr.Mode[(532)]==0)
		cr.ModeBase[(532)]=1;
		else
		cr.ModeBase[(532)]=0;
	}
	if(answerI==3)
	{
		if(cr.Mode[(511)]==0)
		cr.ModeBase[(511)]=1;
		else
		cr.ModeBase[(511)]=0;
	}
	if(answerI==4)
	{
		if(cr.Mode[(536)]==0)
		cr.ModeBase[(536)]=1;
		else
		cr.ModeBase[(536)]=0;
	}
	if(answerI==5)
	{
		if(cr.Mode[(539)]==0)
		cr.ModeBase[(539)]=1;
		else
		cr.ModeBase[(539)]=0;
	}
	if(answerI==6)
	{
		if(cr.Mode[(540)]==0)
		cr.ModeBase[(540)]=1;
		else
		cr.ModeBase[(540)]=0;
	}
	if(answerI==7)
	{
		if(cr.Mode[(524)]==0)
		cr.ModeBase[(524)]=1;
		else
		cr.ModeBase[(524)]=0;
	}
	if(answerI==8)
	{
		if(cr.Mode[(531)]==0)
		cr.ModeBase[(531)]=1;
		else
		cr.ModeBase[(531)]=0;
	}
	if(answerI==9)
	{
		if(cr.Mode[(512)]==0)
		cr.ModeBase[(512)]=1;
		else
		cr.ModeBase[(512)]=0;
	}
	if(answerI==10)
	{
		if(cr.Mode[(535)]==0)
		cr.ModeBase[(535)]=1;
		else
		cr.ModeBase[(535)]=0;
	}
	if(answerI==11)
	{
		if(cr.Mode[(541)]==0)
		cr.ModeBase[(541)]=1;
		else
		cr.ModeBase[(541)]=0;
	}
	if(answerI==12)
	{
		if(cr.Mode[(522)]==0)
		cr.ModeBase[(522)]=1;
		else
		cr.ModeBase[(522)]=0;
	}
	if(answerI==13)
	{
		if(cr.Mode[(527)]==0)
		cr.ModeBase[(527)]=1;
		else
		cr.ModeBase[(527)]=0;
	}
} 

void GM_PANNEL_ITEM(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(player.GetAccess()>=(2))
	{
		Item@item=GetItem(param0);
		if(@item is null)
		return;
		GM_MAIN_PANNEL_ITEM(player,item);
	}
} 

void GM_MAIN_PANNEL_ITEM(Critter&player,Item&item)
{
	player.StatBase[(90)]=item.Id;
	player.ShowScreen((2),4,"answer_GM_PANNEL_ITEM");
	player.Say((18),"Предмет, protoID ="+item.GetProtoId()+", ид ="+item.Id);
	player.Say((19+(0)),"переменные");
	player.Say((19+(1)),"назначить скрипт");
	player.Say((19+(2)),"флаги - 1");
	player.Say((19+(3)),"флаги - 2");
}     

import int intsetval(uint id,uint val,int value)from"interactive_obj";
import string@intGetValueName(uint val)from"interactive_obj";
import bool intgetval(uint id,int val,int&out value)from"interactive_obj";

uint[]ItemFlags=
{
	(0x00000001),
	(0x00000002),
	(0x00000004),
	(0x00000008),
	(0x00000010),
	(0x00000080),
	(0x00000100),
	(0x00000200),
	(0x00000400),
	(0x00000800),
	(0x00001000),
	(0x00002000),
	(0x00004000),
	(0x00008000),
	(0x00010000), 
	
	(0x00020000),
	(0x00040000),
	(0x00080000),
	(0x00100000),
	(0x00200000),
	(0x00400000),
	(0x00800000),
	(0x01000000),
	(0x02000000),
	(0x04000000),
	(0x08000000),
	(0x10000000),
	(0x20000000),
	(0x40000000)
};
string[]ItemFlagsName=
{
	"HIDDEN",
	"FLAT",
	"NO_BLOCK",
	"SHOOT_THRU",
	"LIGHT_THRU",
	"TWO_HANDS",
	"BIG_GUN",
	"ALWAYS_VIEW",
	"HAS_TIMER",
	"BAD_ITEM",
	"NO_HIGHLIGHT",
	"SHOW_ANIM",
	"SHOW_ANIM_EXT",
	"LIGHT",
	"GECK", 
	
	"TRAP",
	"NO_LIGHT_INFLUENCE",
	"NO_LOOT",
	"NO_STEAL",
	"GAG",
	"COLORIZE",
	"COLORIZE_INV",
	"CAN_USE_ON_SMTH",
	"CAN_LOOK",
	"CAN_TALK",
	"CAN_PICKUP",
	"CAN_USE",
	"HOLODISK",
	"RADIO"
};

void answer_GM_PANNEL_ITEM(Critter&player,uint answerI,string&answerS)
{
	Item@item=GetItem(player.StatBase[(90)]);
	if(@item is null)return;
	switch(answerI)
	{
		case 0:
		{
			player.ShowScreen((2),10,"answer_GM_PANNEL_ITEM_VALS");
			player.Say((18),"Предмет, protoID ="+item.GetProtoId()+", ид ="+item.Id);
			
			int value=0;
			if(intgetval(item.Id,0,value))
			{
				for(uint i=0;i<10;i++)
				{
					intgetval(item.Id,i,value);
					player.Say((19+(i)),intGetValueName(i)+": "+value);
				}
			}
			else
			{
				player.Say((19+(0)),""+item.Val0+" Val0");
				player.Say((19+(1)),""+item.Val1+" Val1");
				player.Say((19+(2)),""+item.Val2+" Val2");
				player.Say((19+(3)),""+item.Val3+" Val3");
				player.Say((19+(4)),""+item.Val4+" Val4");
				player.Say((19+(5)),""+item.Val5+" Val5");
				player.Say((19+(6)),""+item.Val6+" Val6");
				player.Say((19+(7)),""+item.Val7+" Val7");
				player.Say((19+(8)),""+item.Val8+" Val8");
				player.Say((19+(9)),""+item.Val9+" Val9");
			}
		}break;
		
		case 1:
		{
			player.ShowScreen((2),5,"answer_GM_PANNEL_ITEM_SCRIPT");
			player.Say((18),"Предмет, protoID ="+item.GetProtoId()+", ид ="+item.Id);
			player.Say((19+(0)),"верстак");
			player.Say((19+(1)),"плавильня");
			player.Say((19+(2)),"монетный пресс");
			player.Say((19+(3)),"пилорама");
			player.Say((19+(4)),"токарный станок");
		}break;
		
		case 2:
		{
			player.ShowScreen((2),15,"answer_GM_PANNEL_ITEM_Flags0");
			player.Say((18),"Предмет, protoID ="+item.GetProtoId()+", ид ="+item.Id);
			for(uint i=0;i<15;i++)
			player.Say((19+(i)),ItemFlagsName[i]+": "+(((item.Flags)&(ItemFlags[i]))!=0));
			
		}break;
		
		case 3:
		{
			player.ShowScreen((2),14,"answer_GM_PANNEL_ITEM_Flags1");
			player.Say((18),"Предмет, protoID ="+item.GetProtoId()+", ид ="+item.Id);
			for(uint i=0;i<14;i++)
			player.Say((19+(i)),ItemFlagsName[i+15]+": "+(((item.Flags)&(ItemFlags[i+15]))!=0));
		}break;
		
		default:break;
	}
}

void answer_GM_PANNEL_ITEM_Flags0(Critter&player,uint answerI,string&answerS)
{
	Item@item=GetItem(player.Stat[(90)]);
	if(@item is null)return;
	if((((item.Flags)&(ItemFlags[answerI]))!=0))
	(item.Flags=((item.Flags)&(~(ItemFlags[answerI]))));
	else(item.Flags=(item.Flags)|(ItemFlags[answerI]));
	GM_MAIN_PANNEL_ITEM(player,item);
}

void answer_GM_PANNEL_ITEM_Flags1(Critter&player,uint answerI,string&answerS)
{
	answer_GM_PANNEL_ITEM_Flags0(player,answerI+15,answerS);
}

void answer_GM_PANNEL_ITEM_SCRIPT(Critter&player,uint answerI,string&answerS)
{
	Item@item=GetItem(player.Stat[(90)]);
	if(item is null)
	return;
	if(answerI==0){
		if(item.GetProtoId()!=157){player.Say((11),"Не тот прототип.");return;}
		else SetWorkbench(player,item.Id,0,0);
	}
	if(answerI==1){
		if(item.GetProtoId()!=1309){player.Say((11),"Не тот прототип.");return;}
		else SetWorkbench(player,item.Id,1,0);
	}
	if(answerI==2){
		if(item.GetProtoId()!=157){player.Say((11),"Не тот прототип.");return;}
		else SetWorkbench(player,item.Id,0,0);
	}
	if(answerI==3){
		if(item.GetProtoId()!=157){player.Say((11),"Не тот прототип.");return;}
		else SetWorkbench(player,item.Id,0,0);
	}
	if(answerI==4){
		if(item.GetProtoId()!=157){player.Say((11),"Не тот прототип.");return;}
		else SetWorkbench(player,item.Id,0,0);
	}
}

void answer_GM_PANNEL_ITEM_VALS(Critter&player,uint answerI,string&answerS)
{
	Item@item=GetItem(player.Stat[(90)]);
	if(@item is null)
	return;
	
	player.StatBase[(91)]=answerI;
	player.ShowScreen((5),0,"gm@ask_GM_PANNEL_ITEM");
	player.Say((39),"Val"+answerI);
}

void ask_GM_PANNEL_ITEM(Critter&player,uint answerI,string&answerS)
{
	Item@item=GetItem(player.StatBase[(90)]);
	if(@item is null)return;
	if(answerS.length()>0)
	{
		int val_number=player.StatBase[(91)];
		int number=0;
		StrToInt(answerS,number);
		int value=0;
		if(intgetval(item.Id,val_number,value))
		{
			intsetval(item.Id,val_number,number);
			player.Say((11),"вы изменили "+intGetValueName(val_number)+" на "+number+" у предмета "+item.Id);
		}
		else
		{
			switch(val_number)
			{
				case 0:item.Val0=number;break;
				case 1:item.Val1=number;break;
				case 2:item.Val2=number;break;
				case 3:item.Val3=number;break;
				case 4:item.Val4=number;break;
				case 5:item.Val5=number;break;
				case 6:item.Val6=number;break;
				case 7:item.Val7=number;break;
				case 8:item.Val8=number;break;
				case 9:item.Val9=number;break;
			}
			player.Say((11),"вы изменили val"+val_number+" на "+number+" у предмета "+item.Id);
		}
		
		answer_GM_PANNEL_ITEM(player,0,answerS);
	}
}

void GM_PANNEL_HEX(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(player.GetAccess()>=(2))
	{
		player.ShowScreen((2),4,"answer_GM_PANNEL_HEX");
		player.Say((18),"Действия с пустым гексом x "+param0+" y "+param1);
		player.MercBase[(803)]=param0;
		player.MercBase[(804)]=param1;
		player.Say((19+(0)),"повтор спавн");
		player.Say((19+(1)),"создать нпц");
		player.Say((19+(2)),"Переместиться");
		player.Say((19+(3)),"TeleportByID");
	}
}

void ask_GM_PANNEL_HEX_GET_CRITTER_ID(Critter&player,uint answerI,string&answerS)
{
	if(answerS.length()>0)
	{
		int id=-1;
		if(StrToInt(answerS,id)&&id!=-1)
		{
			Critter@critter=GetCritter(id);
			if(@critter!is null)
			critter.TransitToMap(player.GetMap().Id,player.Merc[(803)],player.Merc[(804)],0);
		}
	}
}

void answer_GM_PANNEL_HEX(Critter&player,uint answerI,string&answerS)
{
	int weapon=player.Merc[(807)],
	AI_type=player.Merc[(805)],
	hexX=player.Merc[(803)],
	hexY=player.Merc[(804)],
	bonus_hp=player.Merc[(808)],
	bonus_dmg=player.Merc[(809)],
	bonus_skill=player.Merc[(810)];
	
	switch(answerI)
	{
		case 0:
		{
			Map@map=player.GetMap();
			GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
			GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
		}break;
		
		case 1:
		{
			string plead;
			player.ShowScreen((2),12,"answer_GM_PANNEL_HEX_SPAWN");
			player.Say((18),"Выберите тип спавна нпц, АИ="+GetAiName(AI_type,player)+", ХП+="+bonus_hp+", Дмг+="+bonus_dmg+", skill+="+bonus_skill);
			player.Say((19+(0)),"АИ ");
			player.Say((19+(1)),"животные");
			player.Say((19+(2)),"монстры");
			player.Say((19+(3)),"рейдеры");
			player.Say((19+(4)),"мутанты");
			player.Say((19+(5)),"гражданские");
			player.Say((19+(6)),"разное");
			player.Say((19+(7)),"бонус хп");
			player.Say((19+(8)),"бонус дмг");
			player.Say((19+(9)),"бонус скил");
			player.Say((19+(10)),"назад");
		}break;
		
		case 2:
		{
			player.TransitToHex(hexX,hexY,player.Dir);
		}break;
		
		case 3:
		{
			
			player.ShowScreen((5),0,"ask_GM_PANNEL_HEX_GET_CRITTER_ID");
			player.Say((39),"Введите айди криттера");
		}break;
		
		default:break;
	}
}

string@GetAiName(uint index,Critter@cr)
{
	switch(index)
	{
		case 0:return"контроль";
		case 1:return"животное";
		case 2:return"агрессия";
		case 3:return"охрана";
		case 4:return"лидер";
		case 5:return"миньон";
		case 6:return"болванка";
		case 7:
		{
			if(@cr is null)
			return"Произвольное"; 
			
			GMPreset@preset=GetPreset(cr);
			if(@preset.spawn.script!is null)
			return@preset.spawn.script;
			return"Error";
		}
		default:break;
	}
	return"nope";
}

void answer_GM_PANNEL_HEX_SPAWN(Critter&player,uint answerI,string&answerS)
{
	int AI_type=player.Merc[(805)],
	weapon=player.Merc[(807)],
	bonus_hp=player.Merc[(808)],
	bonus_dmg=player.Merc[(809)],
	bonus_skill=player.Merc[(810)];
	if(answerI==0)
	{
		player.ShowScreen((2),8,"answer_GM_PANNEL_HEX_SPAWN_AI");
		player.Say((18),"АИ, текущее - "+GetAiName(player.Merc[(805)],player));
		for(uint i=0;i<7;i++)
		player.Say((19+(i)),GetAiName(i,player));
		player.Say((19+(7)),GetAiName(7,null));
	}
	if(answerI==1)
	{
		player.ShowScreen((2),14,"answer_GM_PANNEL_HEX_SPAWN_ANIMAL");
		player.Say((18),"Выберите вид животного, АИ="+GetAiName(AI_type,player)+", ХП+="+bonus_hp+", Дмг+="+bonus_dmg+", skill+="+bonus_skill);
		player.Say((19+(0)),"крыса");
		player.Say((19+(1)),"мантис");
		player.Say((19+(2)),"муравей");
		player.Say((19+(3)),"свинокрыс");
		player.Say((19+(4)),"кротокрыс");
		player.Say((19+(5)),"большой кротокрыс");
		player.Say((19+(6)),"гекко");
		player.Say((19+(7)),"золотой гекко");
		player.Say((19+(8)),"собака");
		player.Say((19+(9)),"малый скорпион");
		player.Say((19+(10)),"большой скорпион");
		player.Say((19+(11)),"брамин");
		player.Say((19+(12)),"хищ.цвет");
		player.Say((19+(13)),"назад");
	}
	if(answerI==2)
	{
		player.ShowScreen((2),9,"answer_GM_PANNEL_HEX_SPAWN_MONSTER");
		player.Say((18),"Выберите вид монстра, АИ="+GetAiName(AI_type,player)+", ХП+="+bonus_hp+", Дмг+="+bonus_dmg+", skill+="+bonus_skill);
		player.Say((19+(0)),"чужой");
		player.Say((19+(1)),"малый коготь");
		player.Say((19+(2)),"большой коготь");
		player.Say((19+(3)),"серый коготь");
		player.Say((19+(4)),"огнегекко");
		player.Say((19+(5)),"кентавр");
		player.Say((19+(6)),"летун");
		player.Say((19+(7)),"болотник");
		player.Say((19+(8)),"назад");
	}
	if(answerI==3)
	{
		player.ShowScreen((2),11,"answer_GM_PANNEL_HEX_SPAWN_RAIDER");
		player.Say((18),"Выберите вид рейдера, АИ="+GetAiName(AI_type,player)+", ХП+="+bonus_hp+", Дмг+="+bonus_dmg+", skill+="+bonus_skill+", оружие="+weapon);
		player.Say((19+(0)),"кан.+нож");
		player.Say((19+(1)),"кан.+копье");
		player.Say((19+(2)),"кан.ж +нож");
		player.Say((19+(3)),"кан.ж +мяч");
		player.Say((19+(4)),"рейдер+дубин");
		player.Say((19+(5)),"рейдер+нож");
		player.Say((19+(6)),"рейдер+винтов");
		player.Say((19+(7)),"рейдер+пистолет");
		player.Say((19+(8)),"рейдерша+пистолет");
		player.Say((19+(9)),"рейдерша+копье");
		player.Say((19+(10)),"рейдерша+пп");
	}
	if(answerI==4)
	{
		player.Say((11),"Игрок не найден.");
	}
	if(answerI==5)
	{
		player.Say((11),"Игрок не найден.");
	}
	if(answerI==6)
	{
		player.Say((11),"Игрок не найден.");
	}
	if(answerI==7)
	{
		player.StatBase[(91)]=(808);
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"бонус хп");
	}
	if(answerI==8)
	{
		player.StatBase[(91)]=(809);
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"бонус дмг");
	}
	if(answerI==9)
	{
		player.StatBase[(91)]=(810);
		player.ShowScreen((5),0,"gm@ask_GM_PANNEL_CRITTER_PLAYER_STATS_SPECIAL");
		player.Say((39),"бонус скилл");
	}
	if(answerI==10)
	{
		GM_PANNEL_HEX(player,player.Merc[(803)],player.Merc[(804)],0,null,null);
	}
	
}

void answer_GM_PANNEL_HEX_SPAWN_AI(Critter&player,uint answerI,string&answerS)
{
	player.MercBase[(805)]=answerI;
	if(answerI==7)
	player.ShowScreen((5),0,"answer_GM_PANNEL_CUSTOM_CRITTER_NPC_AI");
	else
	player.Say((11),"Режим спавна - <"+GetAiName(answerI,player)+">.");
	
}

void answer_GM_PANNEL_CUSTOM_CRITTER_NPC_AI(Critter&player,uint answerI,string&answerS)
{
	@GetPreset(player).spawn.script=answerS;
	player.Say((11),"Режим спавна - <"+answerS+">.");
}

void answer_GM_PANNEL_HEX_SPAWN_ANIMAL(Critter&player,uint answerI,string&answerS)
{
	if(answerI>=0&&answerI<=12)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=answerI+310;
		player.MercBase[(807)]=0;
		
		int weapon=player.Merc[(807)],
		AI_type=player.Merc[(805)],
		hexX=player.Merc[(803)],
		hexY=player.Merc[(804)],
		bonus_hp=player.Merc[(808)],
		bonus_dmg=player.Merc[(809)],
		bonus_skill=player.Merc[(810)];
		
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	else if(answerI==13)
	GM_PANNEL_HEX(player,player.Merc[(803)],player.Merc[(804)],0,null,null);
}

void answer_GM_PANNEL_HEX_SPAWN_MONSTER(Critter&player,uint answerI,string&answerS)
{
	if(answerI>=0&&answerI<=7)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=answerI+323;
		player.MercBase[(807)]=0;
		
		int weapon=player.Merc[(807)],
		AI_type=player.Merc[(805)],
		hexX=player.Merc[(803)],
		hexY=player.Merc[(804)],
		bonus_hp=player.Merc[(808)],
		bonus_dmg=player.Merc[(809)],
		bonus_skill=player.Merc[(810)];
		
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	else if(answerI==8)
	GM_PANNEL_HEX(player,player.Merc[(803)],player.Merc[(804)],0,null,null);
}

void answer_GM_PANNEL_HEX_SPAWN_RAIDER(Critter&player,uint answerI,string&answerS)
{
	int weapon=player.Merc[(807)],
	AI_type=player.Merc[(805)],
	hexX=player.Merc[(803)],
	hexY=player.Merc[(804)],
	bonus_hp=player.Merc[(808)],
	bonus_dmg=player.Merc[(809)],
	bonus_skill=player.Merc[(810)];
	
	if(answerI==0)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=335;
		if(weapon==0)
		{
			weapon=(1418);
			if(Random(0,1)==0)
			weapon=(1419);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==1)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=335;
		if(weapon==0)
		{
			weapon=(7);
			if(Random(0,5)==0)
			weapon=(1043);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==2)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=336;
		if(weapon==0)
		{
			weapon=(1418);
			if(Random(0,1)==0)
			weapon=(1419);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==3)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=336;
		if(weapon==0)
		{
			weapon=(1413);
			if(Random(0,1)==0)
			weapon=(1414);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==4)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=337;
		if(weapon==0)
		{
			weapon=(1423);
			if(Random(0,1)==0)
			weapon=(1420);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==5)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=337;
		if(weapon==0)
		{
			weapon=(4);
			if(Random(0,3)==0)
			weapon=(319);
			else if(Random(0,2)==0)
			weapon=(383);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==6)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=337;
		if(weapon==0)
		{
			weapon=(1407);
			if(Random(0,2)==0)
			weapon=(1406);
			else if(Random(0,1)==0)
			weapon=(300);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==7)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=337;
		if(weapon==0)
		{
			weapon=(299);
			if(Random(0,2)==0)
			weapon=(1408);
			else if(Random(0,5)==0)
			weapon=(1409);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==8)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=338;
		if(weapon==0)
		{
			weapon=(1407);
			if(Random(0,2)==0)
			weapon=(1406);
			else if(Random(0,1)==0)
			weapon=(300);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==9)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=338;
		if(weapon==0)
		{
			weapon=(7);
			if(Random(0,5)==0)
			weapon=(1043);
		}
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
	if(answerI==10)
	{
		Map@map=player.GetMap();
		GetPreset(player).spawn.ProtoId=338;
		if(weapon==0)
		weapon=(1402);
		GM_SPAWN(player,map,weapon,AI_type,hexX,hexY,bonus_hp,bonus_dmg,bonus_skill);
		GM_PANNEL_HEX(player,hexX+Random(-1,1),hexY+Random(-1,1),0,null,null);
	}
}

void answer_GM_PANNEL_HEX_SPAWN_MUTANT(Critter&player,uint answerI,string&answerS)
{
	if(answerI==0)
	{
		player.Say((11),"Игрок не найден.");
	}
}

void Log_Killings(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	file f;
	if(f.open("logs\\killings.txt","a")>=0)
	{
		string type;
		if(player.Quest[(703)]==(0))
		type="Старт";
		else if(player.Quest[(703)]==(1))
		type="Прикл.";
		else if(player.Quest[(703)]==(2))
		type="Выжив.";
		else if(player.Quest[(703)]==(3))
		type="Аркада";
		else if(player.Quest[(703)]==(4))
		type="Тест";
		if(player.GetAccess()==(2))
		type+=" ГМ";
		else if(player.GetAccess()>(2))
		type+=" Админ";
		else
		type="ошибка";
		
		string type2="error";
		Critter@target=GetCritter(param0);
		if(@target!is null)
		{
			if(target.Quest[(703)]==(0))
			type2="Старт";
			else if(target.Quest[(703)]==(1))
			type2="Прикл.";
			else if(target.Quest[(703)]==(2))
			type2="Выжив.";
			else if(target.Quest[(703)]==(3))
			type2="Аркада";
			else if(target.Quest[(703)]==(4))
			type2="Тест";
		}
		
		string date=TimeToString(player);
		Map@map=player.GetMap();
		string place;
		if(map.GetProtoId()==1)
		place="богатый район";
		else if(map.GetProtoId()==4)
		place="административный";
		else if(map.GetProtoId()==6)
		place="рабочий район";
		else if(map.GetProtoId()==9)
		place="бедный район";
		else if(map.GetProtoId()==10)
		place="ворота модока";
		else if(map.GetProtoId()==13)
		place="лесопилка модока";
		else
		place=map.GetProtoId();
		f.writeString(""+date+"\t"+place+"\t"+type+"\t"+player.Id+"\t"+GetPlayerName(player.Id)+"\t"+"\t"+" убил "+type2+" "+"\t"+param0+"\t"+GetPlayerName(param0)+"\n");
		f.close();
		Critter@[]crs;
		GetAllPlayers(crs);
		string str="|0xFFFF0000 <|0xFFFFFF00"+type+" "+GetPlayerName(player.Id)+" ("+player.Id+")  "+" убил "+type2+" "+GetPlayerName(param0)+" ("+param0+")|0xFFFF0000 > |0xFFBB33CC ";
		for(uint i=0,j=crs.length();i<j;i++)
		{
			if(crs[i]is null or crs[i].GetAccess()<(2))
			continue;
			crs[i].Say((11),str);
		}
	}
}

void Log_GM(Critter&player,int crId,int action,int param0,int param1,int param2)
{
	string crname;
	Critter@cr=GetCritter(crId);
	if(cr!is null)
	crname=GetPlayerName(crId);
	string date=TimeToString(player);
	
	if(action==(1))
	{
		string pass;
		if(param0==0)
		{
			if(param1==0)
			pass="чужака";
			if(param1==11)
			pass="гостя";
			if(param1==12)
			pass="гражданина";
		}
		else if(param0==1)
		pass="принудительно чужака";
		else if(param0==2)
		pass="принудительно гостя";
		else if(param0==3)
		pass="принудительно гражданина";
		else if(param0==4)
		pass="принудительно выживальца";
		
		file f;
		if(f.open("logs\\gm\\"+GetPlayerName(player.Id)+".txt","r")<0)
		{
			if(f.open("logs\\gm\\"+GetPlayerName(player.Id)+".txt","w")>=0)
			{
				f.close();
			}
			else
			Log("cant create log file for GM , ID = "+player.Id);
		}
		if(f.open("logs\\gm\\"+GetPlayerName(player.Id)+".txt","a")>=0)
		{
			f.writeString(""+date+"\t"+" активировал "+crId+" "+crname+" как "+pass+"\n");
			f.close();
		}
		if(f.open("logs\\gm\\activations.txt","a")>=0)
		{
			f.writeString(""+date+"\t"+player.Id+"\t"+GetPlayerName(player.Id)+"\t"+"\t"+" активировал "+crId+" "+crname+" как "+pass+"\n");
			f.close();
		}
	}
}

void Log_Crims(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	file f;
	if(f.open("logs\\crims.txt","a")>=0)
	{
		string date=TimeToString(player);
		f.writeString(""+date+"\t"+player.Id+"\t"+GetPlayerName(player.Id)+"\t"+"\t"+" лутал охотки с гвардов"+"\n");
		f.close();
	}
}

void Log_Lockpick(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	string type;
	if(player.Quest[(703)]==(0))
	type="Старт";
	else if(player.Quest[(703)]==(1))
	type="Прикл.";
	else if(player.Quest[(703)]==(2))
	type="Выжив.";
	else if(player.Quest[(703)]==(3))
	type="Аркада";
	else if(player.Quest[(703)]==(4))
	type="Тест";
	if(player.GetAccess()==(2))
	type+=" ГМ";
	else if(player.GetAccess()>(2))
	type+=" Админ";
	else
	type="ошибка";
	Map@map=player.GetMap();
	string[]place_names={"Модок","Саттер","Пирс","Свалка","Феникс","Ферма","Вилла Фокса"};
	uint[]place_PIDs={1232,32,1216,43,131,1260,1263};
	string place;
	uint map_PID=map.GetProtoId();
	int n=place_PIDs.find(map_PID);
	if(n!=-1)place=place_names[n];
	else place=map.GetProtoId();
	
	string date=TimeToString(player);
	
	Item@locker=GetItem(param0);
	
	string prefix=""+date+"\t"+player.Id+"\t"+type+"\t"+GetPlayerName(player.Id)+"\t"+"\t";
	string postfix=" замок "+param0+" сложностью "+(!(@locker!=null)?"null":""+locker.LockerComplexity)+" в "+"\t"+place+"\t ["+player.HexX+", "+player.HexY+"]\n";
	string action="осматривал";
	if(param1==0)
	action="пытался вскрыть";
	if(param1==0&&param2==1)
	action="успешно вскрыл";
	if(param1==1)
	action="ломал";
	file f;
	if(f.open("logs\\lockpick.txt","a")>=0)
	{
		f.writeString(prefix+action+postfix);
		f.close();
	}
}

void Log_Steal(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	string type;
	if(player.Quest[(703)]==(0))
	type="Старт";
	else if(player.Quest[(703)]==(1))
	type="Прикл.";
	else if(player.Quest[(703)]==(2))
	type="Выжив.";
	else if(player.Quest[(703)]==(3))
	type="Аркада";
	else if(player.Quest[(703)]==(4))
	type="Тест";
	if(player.GetAccess()==(2))
	type+=" ГМ";
	else if(player.GetAccess()>(2))
	type+=" Админ";
	else
	type="ошибка";
	Map@map=player.GetMap();
	string place;
	if(map.GetProtoId()==1)
	place="богатый район";
	else if(map.GetProtoId()==4)
	place="административный";
	else if(map.GetProtoId()==6)
	place="рабочий район";
	else if(map.GetProtoId()==9)
	place="бедный район";
	else if(map.GetProtoId()==10)
	place="ворота модока";
	else if(map.GetProtoId()==13)
	place="лесопилка модока";
	else
	place=map.GetProtoId();
	string date=TimeToString(player);
	
	string targetname="";
	Critter@cr=GetCritter(param0);
	if(cr.IsPlayer())
	targetname=GetPlayerName(param0);
	
	file f;
	if(f.open("logs\\steal.txt","a")>=0)
	{
		f.writeString(""+date+"\t"+player.Id+"\t"+type+"\t"+GetPlayerName(player.Id)+"\t"+"\t"+" украл у "+"\t"+param0+"\t"+targetname+"предмет "+param1+" в "+"\t"+place+"\n");
		f.close();
	}
}

void Log_factions(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	int level=param2;
	
	string type;
	string acces;
	if(player.GetAccess()==(2))
	acces="ГМ  ";
	else if(player.GetAccess()>(2))
	acces="Админ  ";
	string date=TimeToString(player);
	file f;
	if(f.open("logs\\factions.txt","a")>=0)
	{
		if(param1==0)
		{
			if(level==0)
			type="Старт";
			else if(level==1)
			type="Прикл.";
			else if(level==2)
			type="Выжив.";
			else if(level==3)
			type="Аркада";
			else if(level==4)
			type="Тест";
			else
			type="ошибка";
			f.writeString(""+date+"\t"+player.Id+acces+"\t"+GetPlayerName(player.Id)+"\t"+"\t"+" изменил режим игры -  "+param0+"\t"+GetPlayerName(param0)+"\t"+"\t на   "+type+"\n");
		}
		else if(param1==1)
		{
			if(level==0)
			type="Чужой";
			else if(level==1)
			type="врем. гость";
			else if(level==2)
			type="гость";
			else if(level==3)
			type="гражданин";
			else if(level==4)
			type="богатый гражданин";
			else if(level==10)
			type="изгой";
			else
			type="ошибка";
			f.writeString(""+date+"\t"+player.Id+acces+"\t"+GetPlayerName(player.Id)+"\t"+"\t"+" изменил пропуск -  "+param0+"\t"+GetPlayerName(param0)+"\t"+"\t на   "+type+"\n");
		}
		else if(param1==2)
		{
			if(level==AnswerIdFactions::NoFaction)
			type="без фракции";
			else if(level==AnswerIdFactions::Administration)
			type="администрация";
			else if(level==AnswerIdFactions::Cop)
			type="полиция";
			else if(level==AnswerIdFactions::Mafia)
			type="мафия";
			else if(level==AnswerIdFactions::Mutant)
			type="мутанты";
			else if(level==AnswerIdFactions::Fort)
			type="форт";
			else if(level==AnswerIdFactions::Raider)
			type="рейдеры";
			else if(level==AnswerIdFactions::Sheriff)
			type="шериф";
			else if(level==AnswerIdFactions::Mayor)
			type="мэр";
			else
			type="ошибка";
			f.writeString(""+date+"\t"+player.Id+acces+"\t"+GetPlayerName(player.Id)+"\t"+"\t"+" изменил фракцию -  "+param0+"\t"+GetPlayerName(param0)+"\t"+"\t на   "+type+"\n");
		}
		f.close();
	}
}  

import void BanId(Critter&player,int id,int hours,int kick)from"banhammer";
import void KickId(Critter&player,int id,int,int)from"banhammer";
import void KickBanIdIp(Critter&player,int id,int hours,int mask_level)from"banhammer";
import void UnbanId(Critter&player,int id,int,int)from"banhammer";
import void GetIps(Critter&player,int id,int,int)from"banhammer";
import void GM_HardBanId(Critter&player,int id)from"banhammer";

void banid(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	BanId(player,param0,param1,param2);
}

void kickid(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	KickId(player,param0,0,0);
}

void kickbanipid(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	KickBanIdIp(player,param0,param1,param2);
}

void unbanid(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	UnbanId(player,param0,0,0);
}

void getips(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	GetIps(player,param0,0,0);
}

void statcompareradius(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	Critter@[]crs;  
	
	if(player.GetMap().GetCrittersHex(player.HexX,player.HexY,param1,(0x0F)|(0x10),crs)>0)
	{
		CrittersStatCompare(player,crs,uint16(param0));
	}
}

void statcompare(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	Critter@[]crs;
	for(uint8 i=0,j=param4.length();i<j;++i)
	{
		Critter@cr=GetCritter(param4[i]);
		if(cr is null)
		continue;
		crs.insertLast(cr);
	}
	CrittersStatCompare(player,crs,uint16(param0));
}

void CrittersStatCompare(Critter&player,Critter@[]&crs,uint16 stat)
{ 
	
	uint16 minVal=0,maxVal=0;
	uint minId=0,maxId=0;
	
	for(uint16 i=0,j=crs.length();i<j;++i)
	{
		uint16 statVal=crs[i].Param[stat];
		if(statVal>maxVal)
		{
			minVal=statVal;
			minId=crs[i].Id;
		}
		else if(statVal<minVal)
		{
			minVal=statVal;
			minId=crs[i].Id;
		}
	}
	
	player.Say((11),"стат : "+stat+"\nминимальное значение : "+minVal+" id : "+minId+"\nмаксимальное значени : "+maxVal+" id : "+minId);
} 

void killbytype(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	Critter@target=GetCritter(param0);
	if(target is null)
	{
		player.Say((11),"не верный криттер");
		return;
	}
	
	uint16 deadType=0;
	if(param1>0&&param1<9)
	deadType=(110)-1+param1;
	else
	deadType=(Random(0,1)>0?(102):(103));              
	
	target.ToDead(deadType,null);
	
}

void GM_teleport_to_next_player(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	Critter@[]crs;
	GetAllPlayers(crs);
	if(uint(player.Stat[(90)])>=crs.length())
	{
		player.StatBase[(90)]=0;
		player.EraseTimeEvents(7);
	}
	Critter@daddy=crs[player.StatBase[(90)]];
	if(!(@daddy!=null))
	{
		player.Say((11),"не верный криттер");
		player.StatBase[(90)]++;
		return;
	}
	player.StatBase[(90)]++;
	if(daddy.Id==player.Id)
	return;
	Map@map=daddy.GetMap();
	if(!(@map!=null))
	{
		player.Say((11),"игрок "+GetPlayerName(daddy.Id)+" на глобале");
		return;
	}
	else if(map.GetProtoId()==90)
	{
		player.Say((11),"игрок "+GetPlayerName(daddy.Id)+" на карте обучения");
		return;
	}
	else if(map.GetProtoId()==92)
	{
		player.Say((11),"игрок "+GetPlayerName(daddy.Id)+" на стартовой карте");
		return;
	}
	uint[]rates;
	player.GetTimeEvents(7,null,null,rates);
	for(uint ii=0;ii<rates.length();ii++)
	{
		if(rates[ii]==daddy.Id)
		{
			player.Say((11),"игрока "+GetPlayerName(daddy.Id)+" уже просматривали ранее");
			return;
		}
	}
	
	uint8 temp_dir=Random(0,5);
	for(uint i=0;i<6;i++)
	{
		uint16 hexX=daddy.HexX,hexY=daddy.HexY;
		map.MoveHexByDir(hexX,hexY,(temp_dir+i)%6,1);
		if(!map.IsHexPassed(hexX,hexY))continue;
		player.TransitToMap(map.Id,hexX,hexY,0);
		player.Say((11),"вы прыгнули к игроку "+GetPlayerName(daddy.Id)+" "+daddy.Id);
		Critter@[]critters;
		map.GetCrittersHex(hexX,hexY,20,(0x0F)|(0x10),critters);
		for(uint j=0;j<critters.length();j++)
		player.AddTimeEvent("cte_visited",10*60*__TimeMultiplier,7,critters[j].Id);
		break;
	}
}

uint cte_visited(Critter&cr,int identifier,uint&rate){return 0;} 

void GM_CONTROLPANNEL_CRITTER(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(player.GetAccess()>=(2))
	{
		player.ShowScreen((2),1,"answer_GM_PANNEL_SELF");
		player.Say((18),"ГМ ПАНЕЛЬ");
		player.Say((19+(0)),"Режимы себя");
	}
}

void GM_CONTROLPANNEL_HEX(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(player.GetAccess()>=(2))
	{
		player.ShowScreen((2),1,"answer_GM_PANNEL_SELF");
		player.Say((18),"ГМ ПАНЕЛЬ");
		player.Say((19+(0)),"Режимы себя");
	}
}                                                                 

import void GM_MobInit(Critter&npc)from"mob";
import void GM_MobBossInit(Critter&npc)from"mob";
import void GM_MobMinionInit(Critter&npc)from"mob";
import void GM_InitCommonGuard(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)from"guards";
import bool AddAttackPlane(Critter&npc,uint priority,Critter&target,bool run)from"npc_planes";

dictionary Presets;
TeleportPreset@global_DefaultTeleportPreset;

TeleportPreset@get_DefaultTeleportPreset()
{
	if(@global_DefaultTeleportPreset is null)
	construct_DefaultTeleportPreset(global_DefaultTeleportPreset);
	return@global_DefaultTeleportPreset;
}

void construct_DefaultTeleportPreset(TeleportPreset@&outPreset)
{
	@outPreset=TeleportPreset("Дефолтные позиции");
	
	objectManager.ParseProtoTypes("gm.teleport",outPreset,"./NextDay/");
	
	TeleportPreset@preset=TeleportPreset("Саттер");
	@preset.targets=array<AnswerPreset@>(0);
	
	Location@loc=GetLocationByPid((32),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Центр");
			teleport.id=map.Id;
			teleport.hexX=319;
			teleport.hexY=301;
			preset.targets.insertLast(@teleport);
		}
	} 
	
	{
		TeleportPreset@side=TeleportPreset("Саттер север");
		@side.targets=array<AnswerPreset@>(0);
		@loc=GetLocationByPid((20),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("NW Руины");
				teleport.id=map.Id;
				teleport.hexX=180;
				teleport.hexY=186;
				side.targets.insertLast(@teleport);
			}
		}
		
		@loc=GetLocationByPid((21),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("N Картер");
				teleport.id=map.Id;
				teleport.hexX=99;
				teleport.hexY=123;
				side.targets.insertLast(@teleport);
			}
		}
		
		@loc=GetLocationByPid((22),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("N Руины");
				teleport.id=map.Id;
				teleport.hexX=181;
				teleport.hexY=183;
				side.targets.insertLast(@teleport);
			}
		}
		
		@loc=GetLocationByPid((23),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("NE Магазин");
				teleport.id=map.Id;
				teleport.hexX=112;
				teleport.hexY=242;
				side.targets.insertLast(@teleport);
			}
		}
		preset.targets.insertLast(side);
		
		@side=TeleportPreset("Саттер юг");
		@side.targets=array<AnswerPreset@>(0);
		@loc=GetLocationByPid((28),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("SW Станция");
				teleport.id=map.Id;
				teleport.hexX=218;
				teleport.hexY=101;
				side.targets.insertLast(@teleport);
			}
		}
		
		@loc=GetLocationByPid((29),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("S Руины");
				teleport.id=map.Id;
				teleport.hexX=234;
				teleport.hexY=187;
				side.targets.insertLast(@teleport);
			}
		}
		
		@loc=GetLocationByPid((30),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("S Парк");
				teleport.id=map.Id;
				teleport.hexX=237;
				teleport.hexY=202;
				side.targets.insertLast(@teleport);
			}
		}
		
		@loc=GetLocationByPid((31),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("SE Казино");
				teleport.id=map.Id;
				teleport.hexX=104;
				teleport.hexY=111;
				side.targets.insertLast(@teleport);
			}
		}
		
		preset.targets.insertLast(side);
		
		@side=TeleportPreset("Саттер восток");
		@side.targets=array<AnswerPreset@>(0);
		@loc=GetLocationByPid((25),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("E Руины");
				teleport.id=map.Id;
				teleport.hexX=124;
				teleport.hexY=237;
				side.targets.insertLast(@teleport);
			}
		}
		
		@loc=GetLocationByPid((27),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("E Железка");
				teleport.id=map.Id;
				teleport.hexX=106;
				teleport.hexY=253;
				side.targets.insertLast(@teleport);
			}
		}
		
		preset.targets.insertLast(side);
		
		@side=TeleportPreset("Саттер запад");
		@side.targets=array<AnswerPreset@>(0);
		@loc=GetLocationByPid((24),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("W Руины");
				teleport.id=map.Id;
				teleport.hexX=226;
				teleport.hexY=93;
				side.targets.insertLast(@teleport);
			}
		}
		
		@loc=GetLocationByPid((26),0);
		if(@loc!is null)
		{
			Map@map=loc.GetMapByIndex(0);
			if(@map!is null)
			{
				MapTeleport teleport("W Железка");
				teleport.id=map.Id;
				teleport.hexX=224;
				teleport.hexY=94;
				side.targets.insertLast(@teleport);
			}
		}
		
		preset.targets.insertLast(side);
	}
	
	outPreset.targets.insertLast(preset);
	
	@preset=TeleportPreset("Модок");
	@preset.targets=array<AnswerPreset@>(0);
	
	@loc=GetLocationByPid((1232),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Город");
			teleport.id=map.Id;
			teleport.hexX=426;
			teleport.hexY=436;
			preset.targets.insertLast(@teleport);
		}
	}
	
	@loc=GetLocationByPid((1248),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Заправка");
			teleport.id=map.Id;
			teleport.hexX=180;
			teleport.hexY=155;
			preset.targets.insertLast(@teleport);
		}
	}
	
	@loc=GetLocationByPid((1253),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Оазис");
			teleport.id=map.Id;
			teleport.hexX=253;
			teleport.hexY=172;
			preset.targets.insertLast(@teleport);
		}
	}
	
	@loc=GetLocationByPid((1251),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Кладбище");
			teleport.id=map.Id;
			teleport.hexX=169;
			teleport.hexY=211;
			preset.targets.insertLast(@teleport);
		}
	}
	
	@loc=GetLocationByPid((1245),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Лагерь караванщиков");
			teleport.id=map.Id;
			teleport.hexX=166;
			teleport.hexY=245;
			preset.targets.insertLast(@teleport);
		}
	}
	
	@loc=GetLocationByPid((1242),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Мост");
			teleport.id=map.Id;
			teleport.hexX=124;
			teleport.hexY=185;
			preset.targets.insertLast(@teleport);
		}
	}
	
	outPreset.targets.insertLast(preset);
	
	@loc=GetLocationByPid((1216),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Пирс");
			teleport.id=map.Id;
			teleport.hexX=100;
			teleport.hexY=233;
			outPreset.targets.insertLast(@teleport);
		}
	}
	
	@preset=TeleportPreset("Феникс");
	@preset.targets=array<AnswerPreset@>(0);
	
	@loc=GetLocationByPid((42),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMap(130);
		if(@map!is null)
		{
			MapTeleport teleport("Феникс");
			teleport.id=map.Id;
			teleport.hexX=162;
			teleport.hexY=196;
			preset.targets.insertLast(@teleport);
		}
		
		@map=loc.GetMap(131);
		if(@map!is null)
		{
			MapTeleport teleport("Подземка");
			teleport.id=map.Id;
			teleport.hexX=146;
			teleport.hexY=180;
			preset.targets.insertLast(@teleport);
		}
	}
	
	outPreset.targets.insertLast(@preset);
	
	@preset=TeleportPreset("Свалка");
	@preset.targets=array<AnswerPreset@>(0);
	
	@loc=GetLocationByPid((43),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMap(135);
		if(@map!is null)
		{
			MapTeleport teleport("Свалка");
			teleport.id=map.Id;
			teleport.hexX=265;
			teleport.hexY=146;
			preset.targets.insertLast(@teleport);
		}
		
		@map=loc.GetMap(136);
		if(@map!is null)
		{
			MapTeleport teleport("Подземка");
			teleport.id=map.Id;
			teleport.hexX=195;
			teleport.hexY=142;
			preset.targets.insertLast(@teleport);
		}
	}
	
	outPreset.targets.insertLast(@preset);
	
	@loc=GetLocationByPid((93),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Стартовая карта");
			teleport.id=map.Id;
			teleport.hexX=298;
			teleport.hexY=185;
			outPreset.targets.insertLast(@teleport);
		}
	}
	
	@loc=GetLocationByPid((90),0);
	if(@loc!is null)
	{
		Map@map=loc.GetMapByIndex(0);
		if(@map!is null)
		{
			MapTeleport teleport("Обучающая карта");
			teleport.id=map.Id;
			teleport.hexX=140;
			teleport.hexY=227;
			outPreset.targets.insertLast(@teleport);
		}
	}
}

class SpawnPreset
{
	SpawnPreset()
	{
		@script=null;
		TeamId=0;
		ProtoId=0;
	}
	
	int[]@get_params()
	{
		int[]params=
		{
			(106),TeamId
		};
		return@params;
	}
	
	uint ProtoId;
	string@script;
	int TeamId;
}

class MapTeleport:AnswerPreset
{
	MapTeleport(string _name="unnamed")
	{
		property_name=_name;
	}
	
	string@name
	{
		get override
		{
			return"Map: "+property_name;
		}
		
		set override
		{
			if(@value!is null)
			property_name=value;
			else property_name="unnamed";
		}
	}
	
	void answer(Critter&player,uint index,string&text)override
	{
		player.TransitToMap(id,hexX,hexY,0);
	}
	
	private string property_name;
	uint id;
	
	uint16 hexX;
	uint16 hexY;
}

interface AnswerController
{
	void clear();
	void show(Critter&gmaster);
	uint get_param();
	uint get_screen();
	void answer(Critter&player,uint index,string&text);
}

interface AnswerPreset
{
	string@name{get;set;}
	void answer(Critter&player,uint index,string&text);
}

class CreateTPPreset:AnswerPreset,AnswerController
{
	string@name
	{
		get override{return"Создать группу";}
		set override{}
	}
	
	void answer(Critter&player,uint index,string&text)override
	{
		if(text!="")
		{
			TeleportPreset new_preset(text);
			AnswerPreset@remember=@parent.targets[parent.targets.length()-2];
			
			@parent.targets[parent.targets.length()-2]=new_preset;
			@parent.targets[parent.targets.length()-1]=remember;
			
			CreateTPPreset new_custom_group();
			RememberTP custom_tp;
			new_preset.targets.insertLast(custom_tp);
			new_preset.targets.insertLast(new_custom_group);
			
			@custom_tp.parent=@new_preset;
			@new_custom_group.parent=@new_preset;
			
			parent.targets.insertLast(this);
		}
		else if(index==uint(-1))
		{
			GMPreset@preset=GetPreset(player);
			if(@preset!is null)@preset.answer=@this;
		}
	}
	
	uint get_param()override
	{
		return 0;
	}
	
	void clear()override{}
	void show(Critter&gmaster)override{}
	uint get_screen()override{return(5);}
	TeleportPreset@parent;
}

class RememberTP:AnswerPreset,AnswerController
{
	string@name
	{
		get override{return"Запомнить место";}
		set override{}
	}
	
	void answer(Critter&player,uint index,string&text)override
	{
		
		Map@map=player.GetMap();
		if(@map is null)
		{
			player.Say((11),"No found position");
			return;
		}
		
		if(text!="")
		{
			MapTeleport new_preset(text);
			
			new_preset.id=map.Id;
			new_preset.hexX=player.HexX;
			new_preset.hexY=player.HexY;
			
			AnswerPreset@new_group=@parent.targets[parent.targets.length()-1];
			
			@parent.targets[parent.targets.length()-2]=new_preset;
			@parent.targets[parent.targets.length()-1]=this;
			
			parent.targets.insertLast(new_group);
		}
		else if(index==uint(-1))
		{
			GMPreset@preset=GetPreset(player);
			if(@preset!is null)@preset.answer=@this;
		}
	}
	
	uint get_param()override
	{
		return 0;
	}
	
	void clear()override{}
	void show(Critter&gmaster)override{}
	uint get_screen()override{return(5);}
	TeleportPreset@parent;
}

class TeleportPreset:AnswerController,AnswerPreset,FileObject
{
	TeleportPreset(string@arg_name)
	{
		property_name=arg_name;
		master_id=0;
		master_map=true;
		@targets=array<AnswerPreset@>(0);
		GlobalDataList.resize(0);
	}
	
	void set_GlobalData(string@name,string@value)override
	
	{
		const uint hash=GetStrHash(name);
		for(uint i=0,iEnd=GlobalDataList.length();i<iEnd;i++)
		if(GlobalDataList[i].Hash==hash)
		{
			GlobalDataList[i].Value=value;
			return;
		}
	}
	
	string@get_GlobalData(string@name)override
	
	{
		const uint hash=GetStrHash(name);
		for(uint i=0,iEnd=GlobalDataList.length();i<iEnd;i++)
		if(GlobalDataList[i].Hash==hash)
		return GlobalDataList[i].Value;
		return null;
	}
	
	private GlobalData@[]GlobalDataList;
	
	string@get_ObjectName()const override
	{
		return"TeleportPreset";
	}
	
	string@get_DictKey()override
	{
		return name;
	}
	
	void FormatStringData(string&nameData,string&data)override
	{
		if(nameData=="GlobalData")
		{
			string@[]globals=splitEx(data," ");
			for(uint i=0,iEnd=globals.length();i<iEnd;i++)
			GlobalDataList.insertLast(GlobalData(globals[i]));
		}
	}
	
	FileObject@get_Pattern(string&arg_name)const override
	{
		return TeleportPreset(arg_name);
	}
	
	FileObject@get_Copy(string&arg_name)override
	{
		TeleportPreset@object=copy;
		@object.name=arg_name;
		return@object;
	}
	
	TeleportPreset@get_copy()
	{
		TeleportPreset@_copy=TeleportPreset(property_name);
		@_copy.targets=@targets;
		return _copy;
	}
	
	uint get_param()override
	{
		if(@targets is null)
		return 0;
		return targets.length();
	}
	
	string get_description()
	{
		Critter@gmaster=GetCritter(master_id);
		Map@map=GetMap();
		if(@map is null)return name;
		Location@loc=map.GetLocation();
		
		string text=name+"\nВаши координаты, х="+loc.WorldX*0.1+", y="+loc.WorldY*0.1;
		text+=" , игроков на карте = "+map.CountPlayers();
		return text;
	}
	
	void clear()override
	{
		
	}
	
	void show(Critter&gmaster)override
	{
		gmaster.Say((18),description);
		uint count=targets.length();
		if(count>20)count=20;
		for(uint i=0,iEnd=targets.length();i<iEnd;i++)
		gmaster.Say((19+(i)),targets[i].name);
	}
	
	uint get_screen()override
	{
		return(2);
	}
	
	string@name
	{
		get override
		{
			return property_name;
		}
		
		set override
		{
			if(@value!is null)
			property_name=value;
			else property_name="unnamed";
		}
	}
	
	Map@GetMap()
	{
		if(master_map)
		{
			if(master_id!=0)
			return::GetMap(master_id);
		}
		else
		{
			Critter@master=GetCritter(master_id);
			if(@master!is null)
			return master.GetMap();
		}
		return null;
	}
	
	void answer(Critter&player,uint index,string&text)override
	{
		if(index==uint(-1))
		{
			GMPreset@preset=GetPreset(player);
			if(@preset!is null)@preset.answer=@this;
		}
		else targets[index].answer(player,uint(-1),text);
	}
	
	bool master_map;
	uint master_id;
	string property_name;
	array<AnswerPreset@>@targets;
}

void answer_preset(Critter&player,uint index,string&text)
{
	GetPreset(player).current_answer.answer(player,index,text);
}

class GMPreset
{
	GMPreset(Critter&gmaster)
	{
		name=GetPlayerName(gmaster.Id);
		master_id=gmaster.Id;
		@spawn=SpawnPreset();
		
		TeleportPreset@copy_default=DefaultTeleportPreset.copy;
		@teleport=TeleportPreset("Телепорт");
		
		RememberTP custom_tp;
		@custom_tp.parent=teleport;
		
		CreateTPPreset custom_group();
		@custom_group.parent=teleport;
		
		teleport.targets.insertLast(copy_default);
		teleport.targets.insertLast(custom_tp);
		teleport.targets.insertLast(custom_group);
		teleport.master_id=master_id;
		teleport.master_map=false;
		
		copy_default.master_id=master_id;
		copy_default.master_map=false;
		
		@current_answer=null;
		
	}
	
	void set_answer(AnswerController@_answer)
	{
		if(@current_answer!is null)
		{
			current_answer.clear();
			@last_answer=current_answer;
		}
		
		@current_answer=@_answer;
		call_answer();
	}
	
	void call_answer()
	{
		if(@current_answer!is null)
		{
			Critter@gmaster=GetCritter(master_id);
			if(@gmaster!is null)
			{
				gmaster.ShowScreen(current_answer.screen,current_answer.param,"answer_preset");
				current_answer.show(gmaster);
			}
		}
	}
	
	uint master_id;
	string name;
	SpawnPreset@spawn;
	TeleportPreset@teleport;
	
	AnswerController@current_answer;
	AnswerController@last_answer;
}

GMPreset@GetPreset(Critter&cr)
{
	GMPreset@preset=null;
	string gm=GetPlayerName(cr.Id);
	if(Presets.exists(gm))
	Presets.get(gm,@preset);
	else
	{
		@preset=GMPreset(cr);
		Presets.set(gm,@preset);
	}
	return@preset;
}

void GM_SPAWN(Critter&player,Map&map,int weapon,int AI_type,uint16 hexX,uint16 hexY,int bonus_hp,int bonus_dmg,int bonus_skill)
{
	GMPreset@preset=@GetPreset(player);
	int[]@params=@preset.spawn.params;
	string@script=null;
	if(@preset.spawn.script!is null)
	@script="Ai@"+preset.spawn.script;
	Critter@cr=map.AddNpc(preset.spawn.ProtoId,hexX,hexY,Random(0,5),@params,null,@script);
	if((@cr!=null))
	{
		cr.SetEvent((2),"_OnDeadEvent");
		cr.StatBase[(105)]=207;
		cr.MercBase[(805)]=10;
		cr.MercBase[(800)]=player.Id;
		cr.StatBase[(84)]=0;
		cr.ModeBase[(517)]=1;
		cr.ModeBase[(522)]=1;
		
		cr.StatBase[(7)]+=bonus_hp;
		cr.StatBase[(10)]+=bonus_dmg;
		cr.SkillBase[(200)]+=bonus_skill;
		cr.SkillBase[(201)]+=bonus_skill;
		cr.SkillBase[(202)]+=bonus_skill;
		cr.SkillBase[(203)]+=bonus_skill;
		cr.SkillBase[(204)]+=bonus_skill;
		cr.SkillBase[(205)]+=bonus_skill;
		
		if(weapon>0)
		cr.AddItem(weapon,1);
		if(@script is null)
		{
			if(AI_type==0)
			gmcontrolMob(player,cr.Id,0,0,null,null);
			else if(AI_type==1)
			GM_MobInit(cr);
			else if(AI_type==2)
			{
				Critter@[]players,guards;
				Map@map=player.GetMap();
				if((@player!=null)&&(@cr!=null)&&map.GetCritters(0,(0x03)|(0x10),players)>0)
				{
					for(uint j=0,jj=players.length();j<jj;j++)
					{
						if(players[j].Id!=uint(cr.Merc[(800)]))
						{
							AddAttackPlane(cr,0,players[j],__RunOnCombat);
							cr.AddEnemyInStack(players[j].Id);
						}
					}
				}
			}
			else if(AI_type==3)
			GM_InitCommonGuard(player,cr.Id,0,0,null,null);
			else if(AI_type==4)
			GM_MobBossInit(cr);
			else if(AI_type==5)
			GM_MobMinionInit(cr);
		}
	}
}

void gmcontrolMob(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	player.RunClientScript("client_gui@_SetControlCritters",param0,0,0,null,null);
}

void _OnDeadEvent(Critter&dead,Critter@killer)
{
	dead.AddTimeEvent("cte_deleteCorpse",60*30,0);
}

uint cte_deleteCorpse(Critter&dead,int identifier,uint&rate)
{
	DeleteNpc(dead);
	return 0;
}

string TimeToString(Critter&player)
{
	uint16 year=0;
	uint16 month=0;
	uint16 dayOfWeek=0;
	uint16 day=0;
	uint16 hour=0;
	uint16 minute=0;
	uint16 second=0;
	uint16 milliseconds=0;
	GetTime(year,month,day,dayOfWeek,hour,minute,second,milliseconds);
	return""+(day>9?(""+day):("0"+day))+"."+(month>9?(""+month):("0"+month))+"."+year+" "+(hour>9?(""+hour):("0"+hour))+":"+(minute>9?(""+minute):("0"+minute));
} 

import void arcadehiveinsert(Critter&cr,uint16 x,uint16 y,uint8 type)from"arcade_menu";
import void arcadehivelist(Critter&cr)from"arcade_menu";
import void arcadehiveclear(Critter&cr)from"arcade_menu";
import void arcadehivedelone(Critter&cr,uint8 index)from"arcade_menu";

void hiveadd(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	arcadehiveinsert(player,param0,param1,param2);
}

void hivedel(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	arcadehivedelone(player,param0);
}

void hivelist(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	arcadehivelist(player);
}

import int CellLocationCreate(int pid,int x,int y,int force)from"world";
import int CellLocationCreate(int pid,int x,int y,int wild,int livetime,int force)from"world";
import bool CellLocationDelete(int x,int y)from"world";
import int CellLocationSize(int x,int y,int sizeX,int sizeY)from"world"; 

void cell_create_wild(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(@param4!is null&&param4.length()==5)
	CellLocationCreate(param4[0],param4[1],param4[2],param4[3],param4[4],param4[5]);
}

void cell_create(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(@param4!is null&&param4.length()==4)
	CellLocationCreate(param4[0],param4[1],param4[2],param4[3]);
}

void cell_del(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(@param4!is null&&param4.length()==2)
	player.Say((11),"code : "+CellLocationDelete(param4[0],param4[1]));
}

void cell_size(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(@param4!is null&&param4.length()==4)
	player.Say((11),"code : "+CellLocationSize(param4[0],param4[1],param4[2],param4[3]));
}

import void AccountDataBaseCheck(string accountPass)from"accessdb";
import void AcconuntDataBaseAuth(Critter&cr,string accountPass)from"accessdb";

void unsafe_getaccess(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{ 
	
	if(@param3!is null)
	AcconuntDataBaseAuth(player,param3);
}

import bool CellGetCellSize(uint mapId,uint8&sizeX,uint8&sizeY)from"world";

import string CheckAll(uint CheckType)from"handcuffs";
void list(Critter&player,int param0,int param1,int param2)
{
	player.Say((11),CheckAll(param0));
}

bool StickOn=false;

void Stick(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	StickOn=param0==1;
}

void unsafe_Stick(Critter&player,int param0,int param1,int param2,string@param3,int[]@param4)
{
	if(!StickOn)
	return;
	
	Map@map=player.GetMap();
	if(map is null)return;
	
	uint8 sizeX=1,sizeY=1;
	
	CellGetCellSize(map.Id,sizeX,sizeY);
	
	uint16 hexX=0,hexY=0;
	map.GetEntireCoords(255,0,hexX,hexY);
	
	bool isOutX=true,isOutY=true;
	
	if(hexX>player.HexX)
	hexX+=1;
	else if(hexX+150*sizeX<player.HexX)
	hexX+=148*sizeX;
	else
	{
		hexX=player.HexX;
		isOutX=false;
	}
	
	if(hexY>player.HexY)
	hexY+=1;
	else if(hexY+150*sizeY<player.HexY)
	hexY+=148*sizeY;
	else
	{
		hexY=player.HexY;
		isOutY=false;
	}
	
	if(isOutX||isOutY)
	player.TransitToHex(hexX,hexY,player.Dir);
	
	else
	unsafe_help(player,0,0,0,"STICK FLOOD",null);
}
